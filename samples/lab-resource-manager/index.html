
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../openbank/">
      
      
        <link rel="next" href="../api_gateway/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.19">
    
    
      
        <title>Lab Resource Manager - Neuroglia Python Framework</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lab-resource-manager-sample-application" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Neuroglia Python Framework" class="md-header__button md-logo" aria-label="Neuroglia Python Framework" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Neuroglia Python Framework
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab Resource Manager
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../getting-started/" class="md-tabs__link">
        
  
  
    
  
  Getting Started

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../architecture/" class="md-tabs__link">
        
  
  
    
  
  Architecture

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../features/dependency-injection/" class="md-tabs__link">
          
  
  
  Features

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../openbank/" class="md-tabs__link">
          
  
  
  Sample Applications

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Neuroglia Python Framework" class="md-nav__button md-logo" aria-label="Neuroglia Python Framework" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Neuroglia Python Framework
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Features
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/dependency-injection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dependency Injection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/cqrs-mediation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CQRS & Mediation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/resource-oriented-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resource Oriented Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/watcher-reconciliation-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Watcher & Reconciliation Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/watcher-reconciliation-execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Watcher & Reconciliation Execution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/mvc-controllers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MVC Controllers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/data-access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Access
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/event-sourcing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Event Sourcing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/event-handling.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Event Handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/object-mapping.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Object Mapping
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/configuration.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/hosting.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hosting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/core.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/serialization.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Serialization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Sample Applications
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Sample Applications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../openbank/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenBank
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Lab Resource Manager
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Lab Resource Manager
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-youll-learn" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 What You'll Learn
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      🏗️ Architecture
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#domain-model" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 Domain Model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🎯 Domain Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labinstance-resource" class="md-nav__link">
    <span class="md-ellipsis">
      LabInstance Resource
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resource-states" class="md-nav__link">
    <span class="md-ellipsis">
      Resource States
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-resource" class="md-nav__link">
    <span class="md-ellipsis">
      Sample Resource
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#component-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      🔧 Component Implementation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🔧 Component Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-watcher-labinstancewatcher" class="md-nav__link">
    <span class="md-ellipsis">
      1. Watcher: LabInstanceWatcher
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-controller-labinstancecontroller" class="md-nav__link">
    <span class="md-ellipsis">
      2. Controller: LabInstanceController
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-reconciler-labinstancescheduler" class="md-nav__link">
    <span class="md-ellipsis">
      3. Reconciler: LabInstanceScheduler
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#execution-flow" class="md-nav__link">
    <span class="md-ellipsis">
      ⚡ Execution Flow
    </span>
  </a>
  
    <nav class="md-nav" aria-label="⚡ Execution Flow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-resource-creation" class="md-nav__link">
    <span class="md-ellipsis">
      1. Resource Creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-state-progression" class="md-nav__link">
    <span class="md-ellipsis">
      2. State Progression
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-reconciliation-safety" class="md-nav__link">
    <span class="md-ellipsis">
      3. Reconciliation Safety
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-sample" class="md-nav__link">
    <span class="md-ellipsis">
      🚀 Running the Sample
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🚀 Running the Sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-1-full-interactive-demo" class="md-nav__link">
    <span class="md-ellipsis">
      Option 1: Full Interactive Demo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-2-simple-patterns-demo" class="md-nav__link">
    <span class="md-ellipsis">
      Option 2: Simple Patterns Demo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expected-output" class="md-nav__link">
    <span class="md-ellipsis">
      Expected Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-implementation-details" class="md-nav__link">
    <span class="md-ellipsis">
      💡 Key Implementation Details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="💡 Key Implementation Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resource-versioning" class="md-nav__link">
    <span class="md-ellipsis">
      Resource Versioning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Event Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-resilience" class="md-nav__link">
    <span class="md-ellipsis">
      Error Resilience
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concurrent-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Concurrent Processing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#design-patterns-demonstrated" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 Design Patterns Demonstrated
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🎯 Design Patterns Demonstrated">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-observer-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      1. Observer Pattern
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-state-machine" class="md-nav__link">
    <span class="md-ellipsis">
      2. State Machine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-command-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      3. Command Pattern
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-strategy-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      4. Strategy Pattern
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-circuit-breaker" class="md-nav__link">
    <span class="md-ellipsis">
      5. Circuit Breaker
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-options" class="md-nav__link">
    <span class="md-ellipsis">
      🔧 Configuration Options
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🔧 Configuration Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#timing-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Timing Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timeout-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Timeout Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resource-policies" class="md-nav__link">
    <span class="md-ellipsis">
      Resource Policies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-the-sample" class="md-nav__link">
    <span class="md-ellipsis">
      🧪 Testing the Sample
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      🔗 Related Documentation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      🚀 Next Steps
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_gateway/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Gateway
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../desktop_controller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Desktop Controller
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-youll-learn" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 What You'll Learn
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      🏗️ Architecture
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#domain-model" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 Domain Model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🎯 Domain Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#labinstance-resource" class="md-nav__link">
    <span class="md-ellipsis">
      LabInstance Resource
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resource-states" class="md-nav__link">
    <span class="md-ellipsis">
      Resource States
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-resource" class="md-nav__link">
    <span class="md-ellipsis">
      Sample Resource
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#component-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      🔧 Component Implementation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🔧 Component Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-watcher-labinstancewatcher" class="md-nav__link">
    <span class="md-ellipsis">
      1. Watcher: LabInstanceWatcher
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-controller-labinstancecontroller" class="md-nav__link">
    <span class="md-ellipsis">
      2. Controller: LabInstanceController
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-reconciler-labinstancescheduler" class="md-nav__link">
    <span class="md-ellipsis">
      3. Reconciler: LabInstanceScheduler
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#execution-flow" class="md-nav__link">
    <span class="md-ellipsis">
      ⚡ Execution Flow
    </span>
  </a>
  
    <nav class="md-nav" aria-label="⚡ Execution Flow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-resource-creation" class="md-nav__link">
    <span class="md-ellipsis">
      1. Resource Creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-state-progression" class="md-nav__link">
    <span class="md-ellipsis">
      2. State Progression
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-reconciliation-safety" class="md-nav__link">
    <span class="md-ellipsis">
      3. Reconciliation Safety
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-sample" class="md-nav__link">
    <span class="md-ellipsis">
      🚀 Running the Sample
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🚀 Running the Sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-1-full-interactive-demo" class="md-nav__link">
    <span class="md-ellipsis">
      Option 1: Full Interactive Demo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-2-simple-patterns-demo" class="md-nav__link">
    <span class="md-ellipsis">
      Option 2: Simple Patterns Demo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expected-output" class="md-nav__link">
    <span class="md-ellipsis">
      Expected Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-implementation-details" class="md-nav__link">
    <span class="md-ellipsis">
      💡 Key Implementation Details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="💡 Key Implementation Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resource-versioning" class="md-nav__link">
    <span class="md-ellipsis">
      Resource Versioning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Event Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-resilience" class="md-nav__link">
    <span class="md-ellipsis">
      Error Resilience
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concurrent-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Concurrent Processing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#design-patterns-demonstrated" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 Design Patterns Demonstrated
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🎯 Design Patterns Demonstrated">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-observer-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      1. Observer Pattern
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-state-machine" class="md-nav__link">
    <span class="md-ellipsis">
      2. State Machine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-command-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      3. Command Pattern
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-strategy-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      4. Strategy Pattern
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-circuit-breaker" class="md-nav__link">
    <span class="md-ellipsis">
      5. Circuit Breaker
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-options" class="md-nav__link">
    <span class="md-ellipsis">
      🔧 Configuration Options
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🔧 Configuration Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#timing-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Timing Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timeout-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Timeout Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resource-policies" class="md-nav__link">
    <span class="md-ellipsis">
      Resource Policies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-the-sample" class="md-nav__link">
    <span class="md-ellipsis">
      🧪 Testing the Sample
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      🔗 Related Documentation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      🚀 Next Steps
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="lab-resource-manager-sample-application">🧪 Lab Resource Manager Sample Application<a class="headerlink" href="#lab-resource-manager-sample-application" title="Permanent link">&para;</a></h1>
<p>The Lab Resource Manager demonstrates Resource Oriented Architecture (ROA) patterns using Neuroglia's advanced features. It simulates a system for managing ephemeral lab environments for students, showcasing watchers, controllers, and reconciliation loops.</p>
<h2 id="what-youll-learn">🎯 What You'll Learn<a class="headerlink" href="#what-youll-learn" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Resource Oriented Architecture</strong>: Declarative resource management patterns</li>
<li><strong>Watcher Pattern</strong>: Continuous monitoring of resource changes</li>
<li><strong>Controller Pattern</strong>: Event-driven business logic responses</li>
<li><strong>Reconciliation Loops</strong>: Periodic consistency checks and drift correction</li>
<li><strong>State Machine Implementation</strong>: Resource lifecycle management</li>
<li><strong>Asynchronous Coordination</strong>: Multiple concurrent components working together</li>
</ul>
<h2 id="architecture">🏗️ Architecture<a class="headerlink" href="#architecture" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│                    Lab Resource Manager                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐ │
│  │   Watcher       │    │   Controller    │    │  Reconciler     │ │
│  │   (2s polling)  │───▶│   (immediate)   │    │   (10s loop)    │ │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘ │
│           │                       │                       │       │
│           ▼                       ▼                       ▼       │
│  ┌─────────────────────────────────────────────────────────────────┐ │
│  │                    Resource Storage                             │ │
│  │            (Kubernetes-like API with versioning)               │ │
│  └─────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┐
</code></pre></div>
<h2 id="domain-model">🎯 Domain Model<a class="headerlink" href="#domain-model" title="Permanent link">&para;</a></h2>
<h3 id="labinstance-resource">LabInstance Resource<a class="headerlink" href="#labinstance-resource" title="Permanent link">&para;</a></h3>
<p>The core resource representing a student lab environment:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LabInstanceResource</span><span class="p">:</span>
    <span class="n">api_version</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;lab.neuroglia.com/v1&quot;</span>
    <span class="n">kind</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;LabInstance&quot;</span> 
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Name, namespace, timestamps, versions</span>
    <span class="n">spec</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>      <span class="c1"># Desired state: template, duration, student</span>
    <span class="n">status</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>    <span class="c1"># Current state: phase, endpoint, conditions</span>
</code></pre></div>
<h3 id="resource-states">Resource States<a class="headerlink" href="#resource-states" title="Permanent link">&para;</a></h3>
<p>Lab instances progress through a defined lifecycle:</p>
<div class="highlight"><pre><span></span><code>PENDING ──→ PROVISIONING ──→ READY ──→ DELETING ──→ DELETED
   │              │             │
   ▼              ▼             ▼
FAILED        FAILED         FAILED
</code></pre></div>
<h3 id="sample-resource">Sample Resource<a class="headerlink" href="#sample-resource" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;apiVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;lab.neuroglia.com/v1&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LabInstance&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;python-basics-lab&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;student-labs&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;resourceVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;creationTimestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-09-09T21:34:19Z&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;spec&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;template&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;python-basics&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;studentEmail&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;student@example.com&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;duration&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;60m&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;environment&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;PYTHON_VERSION&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3.11&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;state&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ready&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Lab instance is ready&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;endpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://lab-python-basics.example.com&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;readyAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-09-09T21:34:25Z&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="component-implementation">🔧 Component Implementation<a class="headerlink" href="#component-implementation" title="Permanent link">&para;</a></h2>
<h3 id="1-watcher-labinstancewatcher">1. Watcher: LabInstanceWatcher<a class="headerlink" href="#1-watcher-labinstancewatcher" title="Permanent link">&para;</a></h3>
<p>Continuously monitors for resource changes:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LabInstanceWatcher</span><span class="p">:</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">start_watching</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_running</span><span class="p">:</span>
            <span class="c1"># Poll for changes since last known version</span>
            <span class="n">changes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">list_resources</span><span class="p">(</span><span class="n">since_version</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">last_resource_version</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">changes</span><span class="p">:</span>
                <span class="n">resource_version</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resourceVersion&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">resource_version</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_resource_version</span><span class="p">:</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_resource_change</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">last_resource_version</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_resource_version</span><span class="p">,</span> <span class="n">resource_version</span><span class="p">)</span>

            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">poll_interval</span><span class="p">)</span>
</code></pre></div>
<p><strong>Key Features:</strong>
- Polls every 2 seconds for near-real-time responsiveness
- Uses resource versioning to detect changes efficiently
- Notifies multiple event handlers when changes occur
- Handles errors gracefully with continued monitoring</p>
<h3 id="2-controller-labinstancecontroller">2. Controller: LabInstanceController<a class="headerlink" href="#2-controller-labinstancecontroller" title="Permanent link">&para;</a></h3>
<p>Implements business logic for state transitions:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LabInstanceController</span><span class="p">:</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">handle_resource_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">:</span> <span class="n">LabInstanceResource</span><span class="p">):</span>
        <span class="n">current_state</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">current_state</span> <span class="o">==</span> <span class="n">ResourceState</span><span class="o">.</span><span class="n">PENDING</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_provisioning</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">current_state</span> <span class="o">==</span> <span class="n">ResourceState</span><span class="o">.</span><span class="n">PROVISIONING</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_provisioning_status</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">current_state</span> <span class="o">==</span> <span class="n">ResourceState</span><span class="o">.</span><span class="n">READY</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_monitor_lab_instance</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
</code></pre></div>
<p><strong>Key Features:</strong>
- Event-driven processing responding immediately to changes
- State machine implementation with clear transitions
- Business rule enforcement (timeouts, validation, etc.)
- Integration with external provisioning systems</p>
<h3 id="3-reconciler-labinstancescheduler">3. Reconciler: LabInstanceScheduler<a class="headerlink" href="#3-reconciler-labinstancescheduler" title="Permanent link">&para;</a></h3>
<p>Provides safety and eventual consistency:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LabInstanceScheduler</span><span class="p">:</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">start_reconciliation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_running</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reconcile_all_resources</span><span class="p">()</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reconcile_interval</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_reconcile_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="c1"># Check for stuck states</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_stuck_provisioning</span><span class="p">(</span><span class="n">resource</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mark_as_failed</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="s2">&quot;Provisioning timeout&quot;</span><span class="p">)</span>

        <span class="c1"># Check for expiration</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_expired</span><span class="p">(</span><span class="n">resource</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_schedule_deletion</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
</code></pre></div>
<p><strong>Key Features:</strong>
- Runs every 10 seconds scanning all resources
- Detects stuck states and takes corrective action
- Enforces business policies (lab expiration, cleanup)
- Provides safety net for controller failures</p>
<h2 id="execution-flow">⚡ Execution Flow<a class="headerlink" href="#execution-flow" title="Permanent link">&para;</a></h2>
<h3 id="1-resource-creation">1. Resource Creation<a class="headerlink" href="#1-resource-creation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>1. API creates LabInstance resource (state: PENDING)
2. Storage backend assigns resource version and timestamps
3. Watcher detects new resource on next poll cycle (≤2s)
4. Controller receives event and starts provisioning
5. Resource state transitions to PROVISIONING
</code></pre></div>
<h3 id="2-state-progression">2. State Progression<a class="headerlink" href="#2-state-progression" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>6. Watcher detects state change to PROVISIONING
7. Controller checks provisioning status periodically
8. When provisioning completes, state transitions to READY
9. Watcher detects READY state
10. Controller begins monitoring ready lab instance
</code></pre></div>
<h3 id="3-reconciliation-safety">3. Reconciliation Safety<a class="headerlink" href="#3-reconciliation-safety" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>11. Reconciler runs every 10 seconds checking all resources
12. Detects if any resource is stuck in PROVISIONING too long
13. Marks stuck resources as FAILED with timeout message
14. Detects expired READY resources and schedules deletion
</code></pre></div>
<h2 id="running-the-sample">🚀 Running the Sample<a class="headerlink" href="#running-the-sample" title="Permanent link">&para;</a></h2>
<h3 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>samples/lab-resource-manager
</code></pre></div>
<h3 id="option-1-full-interactive-demo">Option 1: Full Interactive Demo<a class="headerlink" href="#option-1-full-interactive-demo" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>run_watcher_demo.py
</code></pre></div>
<p>This runs the complete demonstration showing:
- Resource creation and state transitions
- Watcher detecting changes in real-time
- Controller responding with business logic
- Reconciler providing safety and cleanup</p>
<h3 id="option-2-simple-patterns-demo">Option 2: Simple Patterns Demo<a class="headerlink" href="#option-2-simple-patterns-demo" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>simple_demo.py
</code></pre></div>
<p>A simplified version focusing on the core patterns without framework dependencies.</p>
<h3 id="expected-output">Expected Output<a class="headerlink" href="#expected-output" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>🎯 Resource Oriented Architecture: Watcher &amp; Reconciliation Demo
============================================================
👀 LabInstance Watcher started
🔄 LabInstance Scheduler started reconciliation
📦 Created resource: student-labs/python-basics-lab
🔍 Watcher detected change: student-labs/python-basics-lab -&gt; pending
🎮 Controller processing: student-labs/python-basics-lab (state: pending)
🚀 Starting provisioning for: student-labs/python-basics-lab
🔄 Updated resource: student-labs/python-basics-lab -&gt; {&#39;status&#39;: {&#39;state&#39;: &#39;provisioning&#39;}}
🔍 Watcher detected change: student-labs/python-basics-lab -&gt; provisioning
🎮 Controller processing: student-labs/python-basics-lab (state: provisioning)
🔄 Reconciling 2 lab instances
⚠️ Reconciler: Lab instance stuck in provisioning: student-labs/python-basics-lab
</code></pre></div>
<h2 id="key-implementation-details">💡 Key Implementation Details<a class="headerlink" href="#key-implementation-details" title="Permanent link">&para;</a></h2>
<h3 id="resource-versioning">Resource Versioning<a class="headerlink" href="#resource-versioning" title="Permanent link">&para;</a></h3>
<p>Each resource change increments the version:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">updates</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
    <span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">[</span><span class="n">resource_id</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">resource_version</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">resource</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;resourceVersion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resource_version</span><span class="p">)</span>
</code></pre></div>
<h3 id="event-handling">Event Handling<a class="headerlink" href="#event-handling" title="Permanent link">&para;</a></h3>
<p>Watchers notify multiple handlers:</p>
<div class="highlight"><pre><span></span><code><span class="n">watcher</span><span class="o">.</span><span class="n">add_event_handler</span><span class="p">(</span><span class="n">controller</span><span class="o">.</span><span class="n">handle_resource_event</span><span class="p">)</span>
<span class="n">watcher</span><span class="o">.</span><span class="n">add_event_handler</span><span class="p">(</span><span class="n">audit_logger</span><span class="o">.</span><span class="n">log_change</span><span class="p">)</span>
<span class="n">watcher</span><span class="o">.</span><span class="n">add_event_handler</span><span class="p">(</span><span class="n">metrics_collector</span><span class="o">.</span><span class="n">record_event</span><span class="p">)</span>
</code></pre></div>
<h3 id="error-resilience">Error Resilience<a class="headerlink" href="#error-resilience" title="Permanent link">&para;</a></h3>
<p>All components handle errors gracefully:</p>
<div class="highlight"><pre><span></span><code><span class="k">try</span><span class="p">:</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_provision_lab_instance</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Provisioning failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mark_as_failed</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div>
<h3 id="concurrent-processing">Concurrent Processing<a class="headerlink" href="#concurrent-processing" title="Permanent link">&para;</a></h3>
<p>Components run independently:</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">watcher_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">watcher</span><span class="o">.</span><span class="n">start_watching</span><span class="p">())</span>
    <span class="n">scheduler_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">scheduler</span><span class="o">.</span><span class="n">start_reconciliation</span><span class="p">())</span>

    <span class="c1"># Both run concurrently until stopped</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">watcher_task</span><span class="p">,</span> <span class="n">scheduler_task</span><span class="p">)</span>
</code></pre></div>
<h2 id="design-patterns-demonstrated">🎯 Design Patterns Demonstrated<a class="headerlink" href="#design-patterns-demonstrated" title="Permanent link">&para;</a></h2>
<h3 id="1-observer-pattern">1. <strong>Observer Pattern</strong><a class="headerlink" href="#1-observer-pattern" title="Permanent link">&para;</a></h3>
<p>Watchers observe storage and notify controllers of changes.</p>
<h3 id="2-state-machine">2. <strong>State Machine</strong><a class="headerlink" href="#2-state-machine" title="Permanent link">&para;</a></h3>
<p>Resources progress through well-defined states with clear transitions.</p>
<h3 id="3-command-pattern">3. <strong>Command Pattern</strong><a class="headerlink" href="#3-command-pattern" title="Permanent link">&para;</a></h3>
<p>Controllers execute commands based on resource state.</p>
<h3 id="4-strategy-pattern">4. <strong>Strategy Pattern</strong><a class="headerlink" href="#4-strategy-pattern" title="Permanent link">&para;</a></h3>
<p>Different provisioning strategies for different lab templates.</p>
<h3 id="5-circuit-breaker">5. <strong>Circuit Breaker</strong><a class="headerlink" href="#5-circuit-breaker" title="Permanent link">&para;</a></h3>
<p>Reconcilers detect failures and prevent cascade issues.</p>
<h2 id="configuration-options">🔧 Configuration Options<a class="headerlink" href="#configuration-options" title="Permanent link">&para;</a></h2>
<h3 id="timing-configuration">Timing Configuration<a class="headerlink" href="#timing-configuration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Development: Fast feedback</span>
<span class="n">watcher</span> <span class="o">=</span> <span class="n">LabInstanceWatcher</span><span class="p">(</span><span class="n">storage</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">LabInstanceScheduler</span><span class="p">(</span><span class="n">storage</span><span class="p">,</span> <span class="n">reconcile_interval</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>

<span class="c1"># Production: Optimized performance  </span>
<span class="n">watcher</span> <span class="o">=</span> <span class="n">LabInstanceWatcher</span><span class="p">(</span><span class="n">storage</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">LabInstanceScheduler</span><span class="p">(</span><span class="n">storage</span><span class="p">,</span> <span class="n">reconcile_interval</span><span class="o">=</span><span class="mf">30.0</span><span class="p">)</span>
</code></pre></div>
<h3 id="timeout-configuration">Timeout Configuration<a class="headerlink" href="#timeout-configuration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LabInstanceController</span><span class="p">:</span>
    <span class="n">PROVISIONING_TIMEOUT</span> <span class="o">=</span> <span class="mi">300</span>  <span class="c1"># 5 minutes</span>
    <span class="n">MAX_RETRIES</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">RETRY_BACKOFF</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># seconds</span>
</code></pre></div>
<h3 id="resource-policies">Resource Policies<a class="headerlink" href="#resource-policies" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LabInstanceScheduler</span><span class="p">:</span>
    <span class="n">DEFAULT_LAB_DURATION</span> <span class="o">=</span> <span class="mi">3600</span>  <span class="c1"># 1 hour</span>
    <span class="n">CLEANUP_GRACE_PERIOD</span> <span class="o">=</span> <span class="mi">300</span>   <span class="c1"># 5 minutes</span>
    <span class="n">MAX_CONCURRENT_PROVISIONS</span> <span class="o">=</span> <span class="mi">10</span>
</code></pre></div>
<h2 id="testing-the-sample">🧪 Testing the Sample<a class="headerlink" href="#testing-the-sample" title="Permanent link">&para;</a></h2>
<p>The sample includes comprehensive tests:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Run all sample tests</span>
pytest<span class="w"> </span>samples/lab-resource-manager/tests/

<span class="c1"># Test individual components</span>
pytest<span class="w"> </span>samples/lab-resource-manager/tests/test_watcher.py
pytest<span class="w"> </span>samples/lab-resource-manager/tests/test_controller.py
pytest<span class="w"> </span>samples/lab-resource-manager/tests/test_reconciler.py
</code></pre></div>
<h2 id="related-documentation">🔗 Related Documentation<a class="headerlink" href="#related-documentation" title="Permanent link">&para;</a></h2>
<ul>
<li><strong><a href="../../features/resource-oriented-architecture/">🎯 Resource Oriented Architecture</a></strong> - Core ROA concepts</li>
<li><strong><a href="../../features/watcher-reconciliation-patterns/">🏗️ Watcher &amp; Reconciliation Patterns</a></strong> - Detailed patterns</li>
<li><strong><a href="../../features/watcher-reconciliation-execution/">⚡ Execution Flow</a></strong> - Component coordination</li>
<li><strong><a href="../../features/cqrs-mediation/">🎯 CQRS &amp; Mediation</a></strong> - Command/Query handling</li>
<li><strong><a href="../../features/data-access/">🗄️ Data Access</a></strong> - Storage patterns</li>
</ul>
<h2 id="next-steps">🚀 Next Steps<a class="headerlink" href="#next-steps" title="Permanent link">&para;</a></h2>
<p>After exploring this sample:</p>
<ol>
<li><strong>Extend the Domain</strong>: Add more resource types (LabTemplate, StudentSession)</li>
<li><strong>Add Persistence</strong>: Integrate with MongoDB or Event Store</li>
<li><strong>Implement Authentication</strong>: Add student authentication and authorization</li>
<li><strong>Add Monitoring</strong>: Integrate metrics collection and alerting</li>
<li><strong>Scale Horizontally</strong>: Implement resource sharding for multiple instances</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/bvandewe/pyneuro" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "search.highlight", "search.share"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>