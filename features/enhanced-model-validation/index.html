
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../case-conversion-utilities/" rel="prev"/>
<link href="../mermaid-diagrams/" rel="next"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.20" name="generator"/>
<title>Enhanced Model Validation - Neuroglia Python Framework</title>
<link href="../../assets/stylesheets/main.e53b48f4.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="blue" data-md-color-primary="blue" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#enhanced-model-validation">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Neuroglia Python Framework" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Neuroglia Python Framework">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Neuroglia Python Framework
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Enhanced Model Validation
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="blue" data-md-color-media="" data-md-color-primary="blue" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="blue" data-md-color-media="" data-md-color-primary="blue" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<a aria-label="Share" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="Share">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
</a>
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
        
  
  
    
  
  Home

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../getting-started/">
          
  
  
  Getting Started

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../mario-pizzeria/">
          
  
  
  Mario's Pizzeria

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../patterns/">
          
  
  
  Patterns

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../">
          
  
  
  Features

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../guides/">
          
  
  
  Guides

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../samples/">
          
  
  
  Samples

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../references/oauth-oidc-jwt/">
          
  
  
  References

        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Neuroglia Python Framework" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Neuroglia Python Framework">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    Neuroglia Python Framework
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Home
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Getting Started
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../getting-started/">
<span class="md-ellipsis">
    Overview
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../guides/3-min-bootstrap/">
<span class="md-ellipsis">
    3-Minute Bootstrap
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../guides/local-development/">
<span class="md-ellipsis">
    Local Development Setup
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../guides/mario-pizzeria-tutorial/">
<span class="md-ellipsis">
    Mario's Pizzeria Tutorial
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    Mario's Pizzeria
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Mario's Pizzeria
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../mario-pizzeria/">
<span class="md-ellipsis">
    Case Study Overview
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../mario-pizzeria/business-analysis/">
<span class="md-ellipsis">
    Business Analysis
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../mario-pizzeria/technical-architecture/">
<span class="md-ellipsis">
    Technical Architecture
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../mario-pizzeria/domain-design/">
<span class="md-ellipsis">
    Domain Design
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../mario-pizzeria/implementation-guide/">
<span class="md-ellipsis">
    Implementation Guide
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../mario-pizzeria/testing-deployment/">
<span class="md-ellipsis">
    Testing &amp; Deployment
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Patterns
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Patterns
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/">
<span class="md-ellipsis">
    Overview
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/clean-architecture/">
<span class="md-ellipsis">
    Clean Architecture
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/domain-driven-design/">
<span class="md-ellipsis">
    Domain Driven Design
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/dependency-injection/">
<span class="md-ellipsis">
    Dependency Injection
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/cqrs/">
<span class="md-ellipsis">
    CQRS &amp; Mediation
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/event-driven/">
<span class="md-ellipsis">
    Event-Driven
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/event-sourcing/">
<span class="md-ellipsis">
    Event Sourcing
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/reactive-programming/">
<span class="md-ellipsis">
    Reactive Programming
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/repository/">
<span class="md-ellipsis">
    Repository
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/resource-oriented-architecture/">
<span class="md-ellipsis">
    Resource-Oriented Architecture
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/watcher-reconciliation-patterns/">
<span class="md-ellipsis">
    Watcher &amp; Reconciliation Patterns
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/watcher-reconciliation-execution/">
<span class="md-ellipsis">
    Watcher &amp; Reconciliation Execution
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
<span class="md-ellipsis">
    Features
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Features
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Overview
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../mvc-controllers/">
<span class="md-ellipsis">
    MVC Controllers
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../data-access/">
<span class="md-ellipsis">
    Data Access
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../serialization/">
<span class="md-ellipsis">
    Serialization
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../configurable-type-discovery/">
<span class="md-ellipsis">
    Configurable Type Discovery
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../object-mapping/">
<span class="md-ellipsis">
    Object Mapping
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../background-task-scheduling/">
<span class="md-ellipsis">
    Background Task Scheduling
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../redis-cache-repository/">
<span class="md-ellipsis">
    Redis Cache Repository
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../http-service-client/">
<span class="md-ellipsis">
    HTTP Service Client
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../case-conversion-utilities/">
<span class="md-ellipsis">
    Case Conversion Utilities
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Enhanced Model Validation
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Enhanced Model Validation
    
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
<span class="md-ellipsis">
      üéØ Overview
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#architecture">
<span class="md-ellipsis">
      üèóÔ∏è Architecture
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-usage">
<span class="md-ellipsis">
      üöÄ Basic Usage
    </span>
</a>
<nav aria-label="üöÄ Basic Usage" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#service-registration">
<span class="md-ellipsis">
      Service Registration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-field-validation">
<span class="md-ellipsis">
      Basic Field Validation
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#business-rule-validators">
<span class="md-ellipsis">
      üèóÔ∏è Business Rule Validators
    </span>
</a>
<nav aria-label="üèóÔ∏è Business Rule Validators" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#custom-business-logic-validation">
<span class="md-ellipsis">
      Custom Business Logic Validation
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#context-aware-validation">
<span class="md-ellipsis">
      üéØ Context-Aware Validation
    </span>
</a>
<nav aria-label="üéØ Context-Aware Validation" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#dynamic-validation-based-on-context">
<span class="md-ellipsis">
      Dynamic Validation Based on Context
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#testing">
<span class="md-ellipsis">
      üß™ Testing
    </span>
</a>
<nav aria-label="üß™ Testing" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#comprehensive-validation-testing">
<span class="md-ellipsis">
      Comprehensive Validation Testing
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance-testing">
<span class="md-ellipsis">
      Performance Testing
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#error-aggregation-and-reporting">
<span class="md-ellipsis">
      üìä Error Aggregation and Reporting
    </span>
</a>
<nav aria-label="üìä Error Aggregation and Reporting" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#comprehensive-error-handling">
<span class="md-ellipsis">
      Comprehensive Error Handling
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#related-documentation">
<span class="md-ellipsis">
      üîó Related Documentation
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../mermaid-diagrams/">
<span class="md-ellipsis">
    Mermaid Diagrams
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-ellipsis">
    Guides
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Guides
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../guides/">
<span class="md-ellipsis">
    Overview
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../guides/project-setup/">
<span class="md-ellipsis">
    Project Setup
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../guides/testing-setup/">
<span class="md-ellipsis">
    Testing Setup
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
<span class="md-ellipsis">
    Samples
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            Samples
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../samples/">
<span class="md-ellipsis">
    Overview
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../samples/openbank/">
<span class="md-ellipsis">
    OpenBank
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../samples/api_gateway/">
<span class="md-ellipsis">
    API Gateway
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../samples/desktop_controller/">
<span class="md-ellipsis">
    Desktop Controller
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
<span class="md-ellipsis">
    References
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
            References
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../references/oauth-oidc-jwt/">
<span class="md-ellipsis">
    OAuth, OIDC &amp; JWT
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../references/source_code_naming_convention/">
<span class="md-ellipsis">
    Source Code Naming Conventions
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../references/12-factor-app/">
<span class="md-ellipsis">
    12-Factor App
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../references/python_type_hints/">
<span class="md-ellipsis">
    Python Type Hints
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../references/python_modular_code/">
<span class="md-ellipsis">
    Python Modular Code
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../references/python_object_oriented/">
<span class="md-ellipsis">
    Python Object-Oriented Programming
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../references/python_generic_types/">
<span class="md-ellipsis">
    Python Generic Types
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
<span class="md-ellipsis">
      üéØ Overview
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#architecture">
<span class="md-ellipsis">
      üèóÔ∏è Architecture
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-usage">
<span class="md-ellipsis">
      üöÄ Basic Usage
    </span>
</a>
<nav aria-label="üöÄ Basic Usage" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#service-registration">
<span class="md-ellipsis">
      Service Registration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-field-validation">
<span class="md-ellipsis">
      Basic Field Validation
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#business-rule-validators">
<span class="md-ellipsis">
      üèóÔ∏è Business Rule Validators
    </span>
</a>
<nav aria-label="üèóÔ∏è Business Rule Validators" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#custom-business-logic-validation">
<span class="md-ellipsis">
      Custom Business Logic Validation
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#context-aware-validation">
<span class="md-ellipsis">
      üéØ Context-Aware Validation
    </span>
</a>
<nav aria-label="üéØ Context-Aware Validation" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#dynamic-validation-based-on-context">
<span class="md-ellipsis">
      Dynamic Validation Based on Context
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#testing">
<span class="md-ellipsis">
      üß™ Testing
    </span>
</a>
<nav aria-label="üß™ Testing" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#comprehensive-validation-testing">
<span class="md-ellipsis">
      Comprehensive Validation Testing
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance-testing">
<span class="md-ellipsis">
      Performance Testing
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#error-aggregation-and-reporting">
<span class="md-ellipsis">
      üìä Error Aggregation and Reporting
    </span>
</a>
<nav aria-label="üìä Error Aggregation and Reporting" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#comprehensive-error-handling">
<span class="md-ellipsis">
      Comprehensive Error Handling
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#related-documentation">
<span class="md-ellipsis">
      üîó Related Documentation
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="enhanced-model-validation">üìä Enhanced Model Validation<a class="headerlink" href="#enhanced-model-validation" title="Permanent link">¬∂</a></h1>
<p>The Neuroglia framework provides comprehensive model validation capabilities with business rule
enforcement, custom validators, and sophisticated exception handling, enabling robust data
integrity across all application layers with contextual validation and error reporting.</p>
<h2 id="overview">üéØ Overview<a class="headerlink" href="#overview" title="Permanent link">¬∂</a></h2>
<p>Modern applications require sophisticated validation beyond basic type checking - business rules,
cross-field validation, conditional logic, and contextual constraints. The framework's enhanced
validation system provides:</p>
<ul>
<li><strong>Business Rule Validation</strong>: Domain-specific validation logic</li>
<li><strong>Custom Validators</strong>: Reusable validation components</li>
<li><strong>Cross-Field Validation</strong>: Dependencies between model fields</li>
<li><strong>Contextual Validation</strong>: Different rules based on context</li>
<li><strong>Rich Error Reporting</strong>: Detailed validation error messages</li>
<li><strong>Performance Optimized</strong>: Efficient validation with early termination</li>
</ul>
<h2 id="architecture">üèóÔ∏è Architecture<a class="headerlink" href="#architecture" title="Permanent link">¬∂</a></h2>
<pre class="mermaid"><code>graph TB
    subgraph "üçï Mario's Pizzeria Models"
        OrderModel[Pizza Order Model]
        CustomerModel[Customer Model]
        MenuModel[Menu Item Model]
        InventoryModel[Inventory Model]
    end

    subgraph "üìä Enhanced Validation Layer"
        ValidationEngine[Validation Engine]
        BusinessRules[Business Rule Validators]
        CustomValidators[Custom Validators]
        ContextValidators[Context-Aware Validators]
    end

    subgraph "üéØ Validation Types"
        FieldValidation[Field Validation]
        CrossFieldValidation[Cross-Field Validation]
        ConditionalValidation[Conditional Validation]
        BusinessLogicValidation[Business Logic Validation]
    end

    subgraph "üìã Error Handling"
        ValidationExceptions[Validation Exceptions]
        ErrorAggregation[Error Aggregation]
        ContextualMessages[Contextual Messages]
    end

    OrderModel --&gt; ValidationEngine
    CustomerModel --&gt; ValidationEngine
    MenuModel --&gt; ValidationEngine
    InventoryModel --&gt; ValidationEngine

    ValidationEngine --&gt; BusinessRules
    ValidationEngine --&gt; CustomValidators
    ValidationEngine --&gt; ContextValidators

    BusinessRules --&gt; FieldValidation
    CustomValidators --&gt; CrossFieldValidation
    ContextValidators --&gt; ConditionalValidation
    ValidationEngine --&gt; BusinessLogicValidation

    ValidationEngine --&gt; ValidationExceptions
    ValidationExceptions --&gt; ErrorAggregation
    ErrorAggregation --&gt; ContextualMessages

    style ValidationEngine fill:#e3f2fd
    style BusinessRules fill:#e8f5e8
    style CustomValidators fill:#fff3e0
    style ContextValidators fill:#f3e5f5</code></pre>
<h2 id="basic-usage">üöÄ Basic Usage<a class="headerlink" href="#basic-usage" title="Permanent link">¬∂</a></h2>
<h3 id="service-registration">Service Registration<a class="headerlink" href="#service-registration" title="Permanent link">¬∂</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">neuroglia.hosting.web</span><span class="w"> </span><span class="kn">import</span> <span class="n">WebApplicationBuilder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">neuroglia.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">EnhancedModelValidator</span><span class="p">,</span> <span class="n">ValidationConfig</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_app</span><span class="p">():</span>
    <span class="n">builder</span> <span class="o">=</span> <span class="n">WebApplicationBuilder</span><span class="p">()</span>

    <span class="c1"># Register enhanced model validation</span>
    <span class="n">validation_config</span> <span class="o">=</span> <span class="n">ValidationConfig</span><span class="p">(</span>
        <span class="n">strict_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">fail_fast</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Collect all validation errors</span>
        <span class="n">include_field_context</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">custom_error_messages</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">builder</span><span class="o">.</span><span class="n">services</span><span class="o">.</span><span class="n">add_enhanced_model_validation</span><span class="p">(</span><span class="n">validation_config</span><span class="p">)</span>

    <span class="n">app</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">app</span>
</code></pre></div>
<h3 id="basic-field-validation">Basic Field Validation<a class="headerlink" href="#basic-field-validation" title="Permanent link">¬∂</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">neuroglia.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">BusinessRuleValidator</span><span class="p">,</span> <span class="n">ValidationContext</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Field</span><span class="p">,</span> <span class="n">validator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">decimal</span><span class="w"> </span><span class="kn">import</span> <span class="n">Decimal</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PizzaOrderModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Pizza order with comprehensive validation."""</span>

    <span class="n">order_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                         <span class="n">description</span><span class="o">=</span><span class="s2">"Unique order identifier"</span><span class="p">)</span>
    <span class="n">customer_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                            <span class="n">description</span><span class="o">=</span><span class="s2">"Customer identifier"</span><span class="p">)</span>

    <span class="c1"># Order items with business validation</span>
    <span class="n">order_items</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s1">'OrderItemModel'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">min_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_items</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                               <span class="n">description</span><span class="o">=</span><span class="s2">"Items in the order"</span><span class="p">)</span>

    <span class="c1"># Financial fields with precision validation</span>
    <span class="n">subtotal</span><span class="p">:</span> <span class="n">Decimal</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                             <span class="n">description</span><span class="o">=</span><span class="s2">"Order subtotal"</span><span class="p">)</span>
    <span class="n">tax_amount</span><span class="p">:</span> <span class="n">Decimal</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                               <span class="n">description</span><span class="o">=</span><span class="s2">"Tax amount"</span><span class="p">)</span>
    <span class="n">delivery_fee</span><span class="p">:</span> <span class="n">Decimal</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">'0.00'</span><span class="p">),</span> <span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                 <span class="n">description</span><span class="o">=</span><span class="s2">"Delivery fee"</span><span class="p">)</span>
    <span class="n">total_amount</span><span class="p">:</span> <span class="n">Decimal</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                 <span class="n">description</span><span class="o">=</span><span class="s2">"Total order amount"</span><span class="p">)</span>

    <span class="c1"># Timing validation</span>
    <span class="n">order_placed_at</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">"Order placement time"</span><span class="p">)</span>
    <span class="n">requested_delivery_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span>
                                                       <span class="n">description</span><span class="o">=</span><span class="s2">"Requested delivery time"</span><span class="p">)</span>

    <span class="c1"># Special requirements</span>
    <span class="n">special_instructions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
                                              <span class="n">description</span><span class="o">=</span><span class="s2">"Special instructions"</span><span class="p">)</span>
    <span class="n">is_rush_order</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">"Rush order flag"</span><span class="p">)</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s1">'order_id'</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_order_id_format</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Validate order ID format."""</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">'^ORD_\d</span><span class="si">{8}</span><span class="s1">_\d</span><span class="si">{3}</span><span class="s1">$'</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Order ID must follow format: ORD_YYYYMMDD_XXX'</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s1">'requested_delivery_time'</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_delivery_time</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Validate requested delivery time."""</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span>

        <span class="n">order_placed_at</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'order_placed_at'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">order_placed_at</span> <span class="ow">and</span> <span class="n">v</span> <span class="o">&lt;=</span> <span class="n">order_placed_at</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Delivery time must be after order placement'</span><span class="p">)</span>

        <span class="c1"># Business rule: delivery must be within next 4 hours</span>
        <span class="k">if</span> <span class="n">order_placed_at</span><span class="p">:</span>
            <span class="n">max_delivery_time</span> <span class="o">=</span> <span class="n">order_placed_at</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="n">max_delivery_time</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Delivery time cannot be more than 4 hours from now'</span><span class="p">)</span>

        <span class="c1"># Business rule: no deliveries between 2 AM and 10 AM</span>
        <span class="n">delivery_hour</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">hour</span>
        <span class="k">if</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">delivery_hour</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Deliveries not available between 2 AM and 10 AM'</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s1">'total_amount'</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_total_calculation</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Validate total amount calculation."""</span>
        <span class="n">subtotal</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'subtotal'</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">'0'</span><span class="p">))</span>
        <span class="n">tax_amount</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'tax_amount'</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">'0'</span><span class="p">))</span>
        <span class="n">delivery_fee</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'delivery_fee'</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">'0'</span><span class="p">))</span>

        <span class="n">expected_total</span> <span class="o">=</span> <span class="n">subtotal</span> <span class="o">+</span> <span class="n">tax_amount</span> <span class="o">+</span> <span class="n">delivery_fee</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">expected_total</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">'0.01'</span><span class="p">):</span>  <span class="c1"># Allow 1 cent rounding difference</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">'Total amount </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1"> does not match calculated total </span><span class="si">{</span><span class="n">expected_total</span><span class="si">}</span><span class="s1">'</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s1">'order_items'</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_order_items_business_rules</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Validate business rules for order items."""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Order must contain at least one item'</span><span class="p">)</span>

        <span class="c1"># Business rule: maximum 5 of same item</span>
        <span class="n">item_counts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">menu_item_id</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">"</span>
            <span class="n">item_counts</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">item_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">item</span><span class="o">.</span><span class="n">quantity</span>
            <span class="k">if</span> <span class="n">item_counts</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Cannot order more than 5 of the same item: </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">item_name</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>

        <span class="c1"># Business rule: rush orders limited to 3 items total</span>
        <span class="n">is_rush</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s1">'is_rush_order'</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">cls</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">is_rush</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Rush orders are limited to 3 items maximum'</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">v</span>

<span class="k">class</span><span class="w"> </span><span class="nc">OrderItemModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Individual order item with validation."""</span>

    <span class="n">menu_item_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">item_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">size</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="sa">r</span><span class="s1">'^(small|medium|large|xl)$'</span><span class="p">)</span>
    <span class="n">base_price</span><span class="p">:</span> <span class="n">Decimal</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Customizations</span>
    <span class="n">selected_toppings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">max_items</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">removed_ingredients</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">max_items</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1"># Quantity and pricing</span>
    <span class="n">quantity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">ge</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">"Item quantity"</span><span class="p">)</span>
    <span class="n">toppings_price</span><span class="p">:</span> <span class="n">Decimal</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">'0.00'</span><span class="p">),</span> <span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">line_total</span><span class="p">:</span> <span class="n">Decimal</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s1">'selected_toppings'</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_toppings</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Validate topping selections."""</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">v</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Duplicate toppings are not allowed'</span><span class="p">)</span>

        <span class="c1"># Business rule: premium toppings limit</span>
        <span class="n">premium_toppings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'truffle'</span><span class="p">,</span> <span class="s1">'caviar'</span><span class="p">,</span> <span class="s1">'gold_flakes'</span><span class="p">]</span>
        <span class="n">premium_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">topping</span> <span class="ow">in</span> <span class="n">v</span> <span class="k">if</span> <span class="n">topping</span> <span class="ow">in</span> <span class="n">premium_toppings</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">premium_count</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Maximum 2 premium toppings allowed per item'</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s1">'line_total'</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_line_total</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Validate line total calculation."""</span>
        <span class="n">base_price</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'base_price'</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">'0'</span><span class="p">))</span>
        <span class="n">toppings_price</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'toppings_price'</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">'0'</span><span class="p">))</span>
        <span class="n">quantity</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'quantity'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">expected_total</span> <span class="o">=</span> <span class="p">(</span><span class="n">base_price</span> <span class="o">+</span> <span class="n">toppings_price</span><span class="p">)</span> <span class="o">*</span> <span class="n">quantity</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">expected_total</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">'0.01'</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">'Line total </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1"> does not match calculated total </span><span class="si">{</span><span class="n">expected_total</span><span class="si">}</span><span class="s1">'</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">v</span>
</code></pre></div>
<h2 id="business-rule-validators">üèóÔ∏è Business Rule Validators<a class="headerlink" href="#business-rule-validators" title="Permanent link">¬∂</a></h2>
<h3 id="custom-business-logic-validation">Custom Business Logic Validation<a class="headerlink" href="#custom-business-logic-validation" title="Permanent link">¬∂</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">neuroglia.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">BusinessRuleValidator</span><span class="p">,</span> <span class="n">ValidationResult</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PizzaOrderBusinessValidator</span><span class="p">(</span><span class="n">BusinessRuleValidator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Comprehensive business rule validation for pizza orders."""</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service_provider</span><span class="p">:</span> <span class="n">ServiceProviderBase</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">service_provider</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inventory_service</span> <span class="o">=</span> <span class="n">service_provider</span><span class="o">.</span><span class="n">get_service</span><span class="p">(</span><span class="n">InventoryService</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">customer_service</span> <span class="o">=</span> <span class="n">service_provider</span><span class="o">.</span><span class="n">get_service</span><span class="p">(</span><span class="n">CustomerService</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menu_service</span> <span class="o">=</span> <span class="n">service_provider</span><span class="o">.</span><span class="n">get_service</span><span class="p">(</span><span class="n">MenuService</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">validate_order_business_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="n">PizzaOrderModel</span><span class="p">,</span>
                                          <span class="n">context</span><span class="p">:</span> <span class="n">ValidationContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValidationResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Validate comprehensive business rules for pizza orders."""</span>

        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Rule 1: Customer validation</span>
        <span class="n">customer_validation</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_customer_eligibility</span><span class="p">(</span><span class="n">order</span><span class="o">.</span><span class="n">customer_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">customer_validation</span><span class="o">.</span><span class="n">is_valid</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">customer_validation</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span>

        <span class="c1"># Rule 2: Inventory availability</span>
        <span class="n">inventory_validation</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_inventory_availability</span><span class="p">(</span><span class="n">order</span><span class="o">.</span><span class="n">order_items</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inventory_validation</span><span class="o">.</span><span class="n">is_valid</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">inventory_validation</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span>

        <span class="c1"># Rule 3: Menu item availability</span>
        <span class="n">menu_validation</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_menu_items</span><span class="p">(</span><span class="n">order</span><span class="o">.</span><span class="n">order_items</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">menu_validation</span><span class="o">.</span><span class="n">is_valid</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">menu_validation</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">menu_validation</span><span class="o">.</span><span class="n">warnings</span><span class="p">)</span>

        <span class="c1"># Rule 4: Order timing validation</span>
        <span class="n">timing_validation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_order_timing</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">timing_validation</span><span class="o">.</span><span class="n">is_valid</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">timing_validation</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span>

        <span class="c1"># Rule 5: Financial validation</span>
        <span class="n">financial_validation</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_financial_constraints</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">financial_validation</span><span class="o">.</span><span class="n">is_valid</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">financial_validation</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ValidationResult</span><span class="p">(</span>
            <span class="n">is_valid</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
            <span class="n">warnings</span><span class="o">=</span><span class="n">warnings</span><span class="p">,</span>
            <span class="n">context</span><span class="o">=</span><span class="n">context</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">validate_customer_eligibility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValidationResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Validate customer is eligible to place orders."""</span>

        <span class="n">customer</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">customer_service</span><span class="o">.</span><span class="n">get_customer_async</span><span class="p">(</span><span class="n">customer_id</span><span class="p">)</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">customer</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">field</span><span class="o">=</span><span class="s2">"customer_id"</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">"Customer not found"</span><span class="p">,</span>
                <span class="n">code</span><span class="o">=</span><span class="s2">"CUSTOMER_NOT_FOUND"</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="n">ValidationResult</span><span class="p">(</span><span class="n">is_valid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">)</span>

        <span class="c1"># Check customer account status</span>
        <span class="k">if</span> <span class="n">customer</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s2">"suspended"</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">field</span><span class="o">=</span><span class="s2">"customer_id"</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">"Customer account is suspended"</span><span class="p">,</span>
                <span class="n">code</span><span class="o">=</span><span class="s2">"CUSTOMER_SUSPENDED"</span>
            <span class="p">))</span>

        <span class="c1"># Check outstanding balance</span>
        <span class="k">if</span> <span class="n">customer</span><span class="o">.</span><span class="n">outstanding_balance</span> <span class="o">&gt;</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">'100.00'</span><span class="p">):</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">field</span><span class="o">=</span><span class="s2">"customer_id"</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Outstanding balance of $</span><span class="si">{</span><span class="n">customer</span><span class="o">.</span><span class="n">outstanding_balance</span><span class="si">}</span><span class="s2"> exceeds limit"</span><span class="p">,</span>
                <span class="n">code</span><span class="o">=</span><span class="s2">"OUTSTANDING_BALANCE_LIMIT"</span>
            <span class="p">))</span>

        <span class="c1"># Check daily order limit</span>
        <span class="n">today_orders</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">customer_service</span><span class="o">.</span><span class="n">get_today_order_count</span><span class="p">(</span><span class="n">customer_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">today_orders</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">field</span><span class="o">=</span><span class="s2">"customer_id"</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">"Daily order limit exceeded (10 orders per day)"</span><span class="p">,</span>
                <span class="n">code</span><span class="o">=</span><span class="s2">"DAILY_ORDER_LIMIT"</span>
            <span class="p">))</span>

        <span class="k">return</span> <span class="n">ValidationResult</span><span class="p">(</span><span class="n">is_valid</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">validate_inventory_availability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_items</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">OrderItemModel</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">ValidationResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Validate ingredient availability for all order items."""</span>

        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">order_items</span><span class="p">:</span>
            <span class="c1"># Get recipe ingredients for menu item</span>
            <span class="n">recipe</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">menu_service</span><span class="o">.</span><span class="n">get_recipe_async</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">menu_item_id</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">recipe</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                    <span class="n">field</span><span class="o">=</span><span class="sa">f</span><span class="s2">"order_items[</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">menu_item_id</span><span class="si">}</span><span class="s2">]"</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Recipe not found for item: </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">item_name</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                    <span class="n">code</span><span class="o">=</span><span class="s2">"RECIPE_NOT_FOUND"</span>
                <span class="p">))</span>
                <span class="k">continue</span>

            <span class="c1"># Check base ingredients</span>
            <span class="k">for</span> <span class="n">ingredient</span> <span class="ow">in</span> <span class="n">recipe</span><span class="o">.</span><span class="n">base_ingredients</span><span class="p">:</span>
                <span class="n">required_quantity</span> <span class="o">=</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">quantity</span> <span class="o">*</span> <span class="n">item</span><span class="o">.</span><span class="n">quantity</span>
                <span class="n">available_quantity</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">inventory_service</span><span class="o">.</span><span class="n">get_available_quantity</span><span class="p">(</span>
                    <span class="n">ingredient</span><span class="o">.</span><span class="n">ingredient_id</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">available_quantity</span> <span class="o">&lt;</span> <span class="n">required_quantity</span><span class="p">:</span>
                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                        <span class="n">field</span><span class="o">=</span><span class="sa">f</span><span class="s2">"order_items[</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">menu_item_id</span><span class="si">}</span><span class="s2">].quantity"</span><span class="p">,</span>
                        <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Insufficient </span><span class="si">{</span><span class="n">ingredient</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: need </span><span class="si">{</span><span class="n">required_quantity</span><span class="si">}</span><span class="s2">, have </span><span class="si">{</span><span class="n">available_quantity</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                        <span class="n">code</span><span class="o">=</span><span class="s2">"INSUFFICIENT_INVENTORY"</span>
                    <span class="p">))</span>

            <span class="c1"># Check topping availability</span>
            <span class="k">for</span> <span class="n">topping_id</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">selected_toppings</span><span class="p">:</span>
                <span class="n">topping_quantity</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">inventory_service</span><span class="o">.</span><span class="n">get_available_quantity</span><span class="p">(</span><span class="n">topping_id</span><span class="p">)</span>
                <span class="n">required_quantity</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">quantity</span>  <span class="c1"># 1 unit per pizza</span>

                <span class="k">if</span> <span class="n">topping_quantity</span> <span class="o">&lt;</span> <span class="n">required_quantity</span><span class="p">:</span>
                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                        <span class="n">field</span><span class="o">=</span><span class="sa">f</span><span class="s2">"order_items[</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">menu_item_id</span><span class="si">}</span><span class="s2">].selected_toppings"</span><span class="p">,</span>
                        <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Topping '</span><span class="si">{</span><span class="n">topping_id</span><span class="si">}</span><span class="s2">' not available in sufficient quantity"</span><span class="p">,</span>
                        <span class="n">code</span><span class="o">=</span><span class="s2">"TOPPING_UNAVAILABLE"</span>
                    <span class="p">))</span>

        <span class="k">return</span> <span class="n">ValidationResult</span><span class="p">(</span><span class="n">is_valid</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">validate_menu_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_items</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">OrderItemModel</span><span class="p">],</span>
                                <span class="n">context</span><span class="p">:</span> <span class="n">ValidationContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValidationResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Validate menu item availability and special conditions."""</span>

        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">order_items</span><span class="p">:</span>
            <span class="n">menu_item</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">menu_service</span><span class="o">.</span><span class="n">get_menu_item_async</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">menu_item_id</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">menu_item</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                    <span class="n">field</span><span class="o">=</span><span class="sa">f</span><span class="s2">"order_items[</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">menu_item_id</span><span class="si">}</span><span class="s2">]"</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Menu item not found: </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">menu_item_id</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                    <span class="n">code</span><span class="o">=</span><span class="s2">"MENU_ITEM_NOT_FOUND"</span>
                <span class="p">))</span>
                <span class="k">continue</span>

            <span class="c1"># Check if item is available</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">menu_item</span><span class="o">.</span><span class="n">is_available</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                    <span class="n">field</span><span class="o">=</span><span class="sa">f</span><span class="s2">"order_items[</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">menu_item_id</span><span class="si">}</span><span class="s2">]"</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Menu item is currently unavailable: </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">item_name</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                    <span class="n">code</span><span class="o">=</span><span class="s2">"MENU_ITEM_UNAVAILABLE"</span>
                <span class="p">))</span>

            <span class="c1"># Check size availability</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">size</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">menu_item</span><span class="o">.</span><span class="n">available_sizes</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                    <span class="n">field</span><span class="o">=</span><span class="sa">f</span><span class="s2">"order_items[</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">menu_item_id</span><span class="si">}</span><span class="s2">].size"</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Size '</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">' not available for </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">item_name</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                    <span class="n">code</span><span class="o">=</span><span class="s2">"SIZE_UNAVAILABLE"</span>
                <span class="p">))</span>

            <span class="c1"># Check seasonal availability</span>
            <span class="k">if</span> <span class="n">menu_item</span><span class="o">.</span><span class="n">is_seasonal</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_in_season</span><span class="p">(</span><span class="n">menu_item</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">current_date</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationWarning</span><span class="p">(</span>
                    <span class="n">field</span><span class="o">=</span><span class="sa">f</span><span class="s2">"order_items[</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">menu_item_id</span><span class="si">}</span><span class="s2">]"</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">"'</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">item_name</span><span class="si">}</span><span class="s2">' is a seasonal item and may not be available"</span><span class="p">,</span>
                    <span class="n">code</span><span class="o">=</span><span class="s2">"SEASONAL_ITEM_WARNING"</span>
                <span class="p">))</span>

            <span class="c1"># Validate price matches current menu price</span>
            <span class="n">current_price</span> <span class="o">=</span> <span class="n">menu_item</span><span class="o">.</span><span class="n">get_price_for_size</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">base_price</span> <span class="o">-</span> <span class="n">current_price</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">'0.01'</span><span class="p">):</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                    <span class="n">field</span><span class="o">=</span><span class="sa">f</span><span class="s2">"order_items[</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">menu_item_id</span><span class="si">}</span><span class="s2">].base_price"</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Price mismatch: expected </span><span class="si">{</span><span class="n">current_price</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">base_price</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                    <span class="n">code</span><span class="o">=</span><span class="s2">"PRICE_MISMATCH"</span>
                <span class="p">))</span>

        <span class="k">return</span> <span class="n">ValidationResult</span><span class="p">(</span>
            <span class="n">is_valid</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
            <span class="n">warnings</span><span class="o">=</span><span class="n">warnings</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_order_timing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="n">PizzaOrderModel</span><span class="p">,</span>
                            <span class="n">context</span><span class="p">:</span> <span class="n">ValidationContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValidationResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Validate order timing constraints."""</span>

        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_time</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">current_datetime</span>

        <span class="c1"># Check restaurant hours</span>
        <span class="n">restaurant_hours</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_restaurant_hours</span><span class="p">(</span><span class="n">current_time</span><span class="o">.</span><span class="n">weekday</span><span class="p">())</span>
        <span class="n">current_hour</span> <span class="o">=</span> <span class="n">current_time</span><span class="o">.</span><span class="n">hour</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">restaurant_hours</span><span class="o">.</span><span class="n">open_hour</span> <span class="o">&lt;=</span> <span class="n">current_hour</span> <span class="o">&lt;</span> <span class="n">restaurant_hours</span><span class="o">.</span><span class="n">close_hour</span><span class="p">):</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">field</span><span class="o">=</span><span class="s2">"order_placed_at"</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Restaurant is closed. Hours: </span><span class="si">{</span><span class="n">restaurant_hours</span><span class="o">.</span><span class="n">open_hour</span><span class="si">}</span><span class="s2">:00 - </span><span class="si">{</span><span class="n">restaurant_hours</span><span class="o">.</span><span class="n">close_hour</span><span class="si">}</span><span class="s2">:00"</span><span class="p">,</span>
                <span class="n">code</span><span class="o">=</span><span class="s2">"RESTAURANT_CLOSED"</span>
            <span class="p">))</span>

        <span class="c1"># Rush order timing validation</span>
        <span class="k">if</span> <span class="n">order</span><span class="o">.</span><span class="n">is_rush_order</span><span class="p">:</span>
            <span class="c1"># Rush orders not allowed in last hour before closing</span>
            <span class="k">if</span> <span class="n">current_hour</span> <span class="o">&gt;=</span> <span class="n">restaurant_hours</span><span class="o">.</span><span class="n">close_hour</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                    <span class="n">field</span><span class="o">=</span><span class="s2">"is_rush_order"</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="s2">"Rush orders not available in the last hour before closing"</span><span class="p">,</span>
                    <span class="n">code</span><span class="o">=</span><span class="s2">"RUSH_ORDER_TOO_LATE"</span>
                <span class="p">))</span>

            <span class="c1"># Check rush order capacity</span>
            <span class="n">current_rush_orders</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"current_rush_orders"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">current_rush_orders</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>  <span class="c1"># Max 5 rush orders at once</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                    <span class="n">field</span><span class="o">=</span><span class="s2">"is_rush_order"</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="s2">"Rush order capacity exceeded. Please try again later."</span><span class="p">,</span>
                    <span class="n">code</span><span class="o">=</span><span class="s2">"RUSH_ORDER_CAPACITY_EXCEEDED"</span>
                <span class="p">))</span>

        <span class="k">return</span> <span class="n">ValidationResult</span><span class="p">(</span><span class="n">is_valid</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">validate_financial_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="n">PizzaOrderModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValidationResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Validate financial business rules."""</span>

        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Minimum order value</span>
        <span class="n">minimum_order</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">'10.00'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">order</span><span class="o">.</span><span class="n">subtotal</span> <span class="o">&lt;</span> <span class="n">minimum_order</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">field</span><span class="o">=</span><span class="s2">"subtotal"</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Minimum order value is $</span><span class="si">{</span><span class="n">minimum_order</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                <span class="n">code</span><span class="o">=</span><span class="s2">"MINIMUM_ORDER_NOT_MET"</span>
            <span class="p">))</span>

        <span class="c1"># Maximum single order value (fraud prevention)</span>
        <span class="n">maximum_order</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">'500.00'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">order</span><span class="o">.</span><span class="n">total_amount</span> <span class="o">&gt;</span> <span class="n">maximum_order</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">field</span><span class="o">=</span><span class="s2">"total_amount"</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Maximum single order value is $</span><span class="si">{</span><span class="n">maximum_order</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                <span class="n">code</span><span class="o">=</span><span class="s2">"MAXIMUM_ORDER_EXCEEDED"</span>
            <span class="p">))</span>

        <span class="c1"># Rush order surcharge validation</span>
        <span class="k">if</span> <span class="n">order</span><span class="o">.</span><span class="n">is_rush_order</span><span class="p">:</span>
            <span class="n">expected_rush_fee</span> <span class="o">=</span> <span class="n">order</span><span class="o">.</span><span class="n">subtotal</span> <span class="o">*</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">'0.20'</span><span class="p">)</span>  <span class="c1"># 20% surcharge</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">order</span><span class="o">.</span><span class="n">delivery_fee</span> <span class="o">-</span> <span class="n">expected_rush_fee</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">'0.01'</span><span class="p">):</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                    <span class="n">field</span><span class="o">=</span><span class="s2">"delivery_fee"</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Rush order delivery fee should be $</span><span class="si">{</span><span class="n">expected_rush_fee</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                    <span class="n">code</span><span class="o">=</span><span class="s2">"RUSH_DELIVERY_FEE_INCORRECT"</span>
                <span class="p">))</span>

        <span class="k">return</span> <span class="n">ValidationResult</span><span class="p">(</span><span class="n">is_valid</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">)</span>
</code></pre></div>
<h2 id="context-aware-validation">üéØ Context-Aware Validation<a class="headerlink" href="#context-aware-validation" title="Permanent link">¬∂</a></h2>
<h3 id="dynamic-validation-based-on-context">Dynamic Validation Based on Context<a class="headerlink" href="#dynamic-validation-based-on-context" title="Permanent link">¬∂</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">neuroglia.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">ContextAwareValidator</span><span class="p">,</span> <span class="n">ValidationContext</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CustomerRegistrationValidator</span><span class="p">(</span><span class="n">ContextAwareValidator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Context-aware validation for customer registration."""</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">validate_customer_registration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">customer_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
                                           <span class="n">context</span><span class="p">:</span> <span class="n">ValidationContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValidationResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Validate customer registration with context-specific rules."""</span>

        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Different validation rules based on registration source</span>
        <span class="n">registration_source</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"registration_source"</span><span class="p">,</span> <span class="s2">"web"</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">registration_source</span> <span class="o">==</span> <span class="s2">"mobile_app"</span><span class="p">:</span>
            <span class="c1"># Mobile app requires phone verification</span>
            <span class="n">mobile_validation</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_mobile_app_requirements</span><span class="p">(</span><span class="n">customer_data</span><span class="p">)</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">mobile_validation</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">registration_source</span> <span class="o">==</span> <span class="s2">"social_login"</span><span class="p">:</span>
            <span class="c1"># Social login has different email validation</span>
            <span class="n">social_validation</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_social_login_requirements</span><span class="p">(</span><span class="n">customer_data</span><span class="p">)</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">social_validation</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">registration_source</span> <span class="o">==</span> <span class="s2">"in_store"</span><span class="p">:</span>
            <span class="c1"># In-store registration allows relaxed validation</span>
            <span class="n">store_validation</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_in_store_requirements</span><span class="p">(</span><span class="n">customer_data</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">store_validation</span><span class="o">.</span><span class="n">warnings</span><span class="p">)</span>

        <span class="c1"># Location-based validation</span>
        <span class="n">customer_location</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"customer_location"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">customer_location</span><span class="p">:</span>
            <span class="n">location_validation</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_location_requirements</span><span class="p">(</span>
                <span class="n">customer_data</span><span class="p">,</span> <span class="n">customer_location</span>
            <span class="p">)</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">location_validation</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span>

        <span class="c1"># Time-based validation (different rules for peak hours)</span>
        <span class="n">current_hour</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">current_datetime</span><span class="o">.</span><span class="n">hour</span>
        <span class="k">if</span> <span class="mi">11</span> <span class="o">&lt;=</span> <span class="n">current_hour</span> <span class="o">&lt;=</span> <span class="mi">14</span><span class="p">:</span>  <span class="c1"># Lunch rush</span>
            <span class="c1"># Expedited validation during peak hours</span>
            <span class="n">peak_validation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_peak_hour_registration</span><span class="p">(</span><span class="n">customer_data</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">peak_validation</span><span class="o">.</span><span class="n">is_valid</span><span class="p">:</span>
                <span class="c1"># Convert some errors to warnings during peak hours</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
                    <span class="n">ValidationWarning</span><span class="p">(</span>
                        <span class="n">field</span><span class="o">=</span><span class="n">error</span><span class="o">.</span><span class="n">field</span><span class="p">,</span>
                        <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Peak hours: </span><span class="si">{</span><span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                        <span class="n">code</span><span class="o">=</span><span class="sa">f</span><span class="s2">"PEAK_</span><span class="si">{</span><span class="n">error</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">"</span>
                    <span class="p">)</span> <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">peak_validation</span><span class="o">.</span><span class="n">errors</span>
                <span class="p">])</span>

        <span class="k">return</span> <span class="n">ValidationResult</span><span class="p">(</span>
            <span class="n">is_valid</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
            <span class="n">warnings</span><span class="o">=</span><span class="n">warnings</span><span class="p">,</span>
            <span class="n">context</span><span class="o">=</span><span class="n">context</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">validate_mobile_app_requirements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">customer_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValidationResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Validate requirements specific to mobile app registration."""</span>

        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Phone number is required for mobile registration</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">customer_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"phone_number"</span><span class="p">):</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">field</span><span class="o">=</span><span class="s2">"phone_number"</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">"Phone number is required for mobile registration"</span><span class="p">,</span>
                <span class="n">code</span><span class="o">=</span><span class="s2">"MOBILE_PHONE_REQUIRED"</span>
            <span class="p">))</span>

        <span class="c1"># Push notification consent</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">customer_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"accepts_push_notifications"</span><span class="p">):</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">field</span><span class="o">=</span><span class="s2">"accepts_push_notifications"</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">"Push notification consent required for mobile app"</span><span class="p">,</span>
                <span class="n">code</span><span class="o">=</span><span class="s2">"PUSH_CONSENT_REQUIRED"</span>
            <span class="p">))</span>

        <span class="k">return</span> <span class="n">ValidationResult</span><span class="p">(</span><span class="n">is_valid</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">validate_location_requirements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">customer_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
                                           <span class="n">location</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValidationResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Validate location-specific requirements."""</span>

        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Check if we deliver to this location</span>
        <span class="n">is_in_delivery_zone</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_delivery_zone</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_in_delivery_zone</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">field</span><span class="o">=</span><span class="s2">"address"</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">"Sorry, we don't deliver to this location yet"</span><span class="p">,</span>
                <span class="n">code</span><span class="o">=</span><span class="s2">"OUTSIDE_DELIVERY_ZONE"</span>
            <span class="p">))</span>

        <span class="c1"># State-specific validation (e.g., age verification requirements)</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"state"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">"CA"</span><span class="p">,</span> <span class="s2">"NY"</span><span class="p">]:</span>  <span class="c1"># States with stricter requirements</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">customer_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"date_of_birth"</span><span class="p">):</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationError</span><span class="p">(</span>
                    <span class="n">field</span><span class="o">=</span><span class="s2">"date_of_birth"</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Date of birth required for registration in </span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                    <span class="n">code</span><span class="o">=</span><span class="s2">"STATE_DOB_REQUIRED"</span>
                <span class="p">))</span>

        <span class="k">return</span> <span class="n">ValidationResult</span><span class="p">(</span><span class="n">is_valid</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">)</span>
</code></pre></div>
<h2 id="testing">üß™ Testing<a class="headerlink" href="#testing" title="Permanent link">¬∂</a></h2>
<h3 id="comprehensive-validation-testing">Comprehensive Validation Testing<a class="headerlink" href="#comprehensive-validation-testing" title="Permanent link">¬∂</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">decimal</span><span class="w"> </span><span class="kn">import</span> <span class="n">Decimal</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">neuroglia.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">ValidationContext</span><span class="p">,</span> <span class="n">ValidationResult</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TestPizzaOrderValidation</span><span class="p">:</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">valid_order_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">"order_id"</span><span class="p">:</span> <span class="s2">"ORD_20241201_001"</span><span class="p">,</span>
            <span class="s2">"customer_id"</span><span class="p">:</span> <span class="s2">"CUST_12345"</span><span class="p">,</span>
            <span class="s2">"order_items"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">"menu_item_id"</span><span class="p">:</span> <span class="s2">"margherita_large"</span><span class="p">,</span>
                    <span class="s2">"item_name"</span><span class="p">:</span> <span class="s2">"Margherita Pizza"</span><span class="p">,</span>
                    <span class="s2">"size"</span><span class="p">:</span> <span class="s2">"large"</span><span class="p">,</span>
                    <span class="s2">"base_price"</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"18.99"</span><span class="p">),</span>
                    <span class="s2">"selected_toppings"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"extra_cheese"</span><span class="p">],</span>
                    <span class="s2">"removed_ingredients"</span><span class="p">:</span> <span class="p">[],</span>
                    <span class="s2">"quantity"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">"toppings_price"</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"2.50"</span><span class="p">),</span>
                    <span class="s2">"line_total"</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"21.49"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">"subtotal"</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"21.49"</span><span class="p">),</span>
            <span class="s2">"tax_amount"</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"1.72"</span><span class="p">),</span>
            <span class="s2">"delivery_fee"</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"2.99"</span><span class="p">),</span>
            <span class="s2">"total_amount"</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"26.20"</span><span class="p">),</span>
            <span class="s2">"order_placed_at"</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">(),</span>
            <span class="s2">"requested_delivery_time"</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">45</span><span class="p">),</span>
            <span class="s2">"special_instructions"</span><span class="p">:</span> <span class="s2">"Ring doorbell"</span><span class="p">,</span>
            <span class="s2">"is_rush_order"</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">}</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validation_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ValidationContext</span><span class="p">(</span>
            <span class="n">current_datetime</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">(),</span>
            <span class="n">current_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">date</span><span class="p">(),</span>
            <span class="n">user_context</span><span class="o">=</span><span class="p">{</span><span class="s2">"customer_id"</span><span class="p">:</span> <span class="s2">"CUST_12345"</span><span class="p">},</span>
            <span class="n">request_context</span><span class="o">=</span><span class="p">{</span><span class="s2">"source"</span><span class="p">:</span> <span class="s2">"web_app"</span><span class="p">}</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_valid_order_passes_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valid_order_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Test that a valid order passes all validation."""</span>

        <span class="n">order</span> <span class="o">=</span> <span class="n">PizzaOrderModel</span><span class="p">(</span><span class="o">**</span><span class="n">valid_order_data</span><span class="p">)</span>

        <span class="c1"># Should not raise any validation errors</span>
        <span class="k">assert</span> <span class="n">order</span><span class="o">.</span><span class="n">order_id</span> <span class="o">==</span> <span class="s2">"ORD_20241201_001"</span>
        <span class="k">assert</span> <span class="n">order</span><span class="o">.</span><span class="n">total_amount</span> <span class="o">==</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"26.20"</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">order</span><span class="o">.</span><span class="n">order_items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_invalid_order_id_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valid_order_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Test order ID format validation."""</span>

        <span class="n">valid_order_data</span><span class="p">[</span><span class="s2">"order_id"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"INVALID_FORMAT"</span>

        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc_info</span><span class="p">:</span>
            <span class="n">PizzaOrderModel</span><span class="p">(</span><span class="o">**</span><span class="n">valid_order_data</span><span class="p">)</span>

        <span class="k">assert</span> <span class="s2">"Order ID must follow format"</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc_info</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_total_calculation_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valid_order_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Test total amount calculation validation."""</span>

        <span class="c1"># Set incorrect total</span>
        <span class="n">valid_order_data</span><span class="p">[</span><span class="s2">"total_amount"</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"99.99"</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc_info</span><span class="p">:</span>
            <span class="n">PizzaOrderModel</span><span class="p">(</span><span class="o">**</span><span class="n">valid_order_data</span><span class="p">)</span>

        <span class="k">assert</span> <span class="s2">"Total amount"</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc_info</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">assert</span> <span class="s2">"does not match calculated total"</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc_info</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_delivery_time_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valid_order_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Test delivery time business rules."""</span>

        <span class="c1"># Set delivery time in the past</span>
        <span class="n">valid_order_data</span><span class="p">[</span><span class="s2">"requested_delivery_time"</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc_info</span><span class="p">:</span>
            <span class="n">PizzaOrderModel</span><span class="p">(</span><span class="o">**</span><span class="n">valid_order_data</span><span class="p">)</span>

        <span class="k">assert</span> <span class="s2">"Delivery time must be after order placement"</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc_info</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_delivery_time_early_hours_restriction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valid_order_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Test early hours delivery restriction."""</span>

        <span class="c1"># Set delivery time at 3 AM (restricted hours)</span>
        <span class="n">tomorrow_3am</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">valid_order_data</span><span class="p">[</span><span class="s2">"requested_delivery_time"</span><span class="p">]</span> <span class="o">=</span> <span class="n">tomorrow_3am</span>

        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc_info</span><span class="p">:</span>
            <span class="n">PizzaOrderModel</span><span class="p">(</span><span class="o">**</span><span class="n">valid_order_data</span><span class="p">)</span>

        <span class="k">assert</span> <span class="s2">"not available between 2 AM and 10 AM"</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc_info</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_maximum_item_quantity_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valid_order_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Test maximum quantity validation."""</span>

        <span class="c1"># Set quantity above limit</span>
        <span class="n">valid_order_data</span><span class="p">[</span><span class="s2">"order_items"</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">"quantity"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
        <span class="n">valid_order_data</span><span class="p">[</span><span class="s2">"order_items"</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">"line_total"</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"322.35"</span><span class="p">)</span>  <span class="c1"># Adjust total</span>
        <span class="n">valid_order_data</span><span class="p">[</span><span class="s2">"subtotal"</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"322.35"</span><span class="p">)</span>
        <span class="n">valid_order_data</span><span class="p">[</span><span class="s2">"total_amount"</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"350.00"</span><span class="p">)</span>  <span class="c1"># Adjust totals</span>

        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc_info</span><span class="p">:</span>
            <span class="n">PizzaOrderModel</span><span class="p">(</span><span class="o">**</span><span class="n">valid_order_data</span><span class="p">)</span>

        <span class="k">assert</span> <span class="s2">"quantity"</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc_info</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_duplicate_toppings_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valid_order_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Test duplicate toppings validation."""</span>

        <span class="c1"># Add duplicate toppings</span>
        <span class="n">valid_order_data</span><span class="p">[</span><span class="s2">"order_items"</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">"selected_toppings"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"extra_cheese"</span><span class="p">,</span> <span class="s2">"extra_cheese"</span><span class="p">,</span> <span class="s2">"pepperoni"</span>
        <span class="p">]</span>

        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc_info</span><span class="p">:</span>
            <span class="n">PizzaOrderModel</span><span class="p">(</span><span class="o">**</span><span class="n">valid_order_data</span><span class="p">)</span>

        <span class="k">assert</span> <span class="s2">"Duplicate toppings are not allowed"</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc_info</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_business_rule_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valid_order_data</span><span class="p">,</span> <span class="n">validation_context</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Test comprehensive business rule validation."""</span>

        <span class="c1"># Mock services</span>
        <span class="n">business_validator</span> <span class="o">=</span> <span class="n">PizzaOrderBusinessValidator</span><span class="p">(</span><span class="n">mock_service_provider</span><span class="p">())</span>

        <span class="n">order</span> <span class="o">=</span> <span class="n">PizzaOrderModel</span><span class="p">(</span><span class="o">**</span><span class="n">valid_order_data</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">business_validator</span><span class="o">.</span><span class="n">validate_order_business_rules</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">validation_context</span><span class="p">)</span>

        <span class="c1"># Should pass basic validation (with mocked services)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">ValidationResult</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_line_total_calculation_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valid_order_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Test line total calculation validation."""</span>

        <span class="c1"># Set incorrect line total</span>
        <span class="n">valid_order_data</span><span class="p">[</span><span class="s2">"order_items"</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">"line_total"</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"99.99"</span><span class="p">)</span>
        <span class="c1"># Keep other totals consistent to isolate this validation</span>

        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc_info</span><span class="p">:</span>
            <span class="n">PizzaOrderModel</span><span class="p">(</span><span class="o">**</span><span class="n">valid_order_data</span><span class="p">)</span>

        <span class="k">assert</span> <span class="s2">"Line total"</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc_info</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">assert</span> <span class="s2">"does not match calculated total"</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc_info</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">mock_service_provider</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""Create mock service provider for testing."""</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">unittest.mock</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mock</span>

    <span class="n">service_provider</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>

    <span class="c1"># Mock inventory service</span>
    <span class="n">inventory_service</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>
    <span class="n">inventory_service</span><span class="o">.</span><span class="n">get_available_quantity</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">(</span><span class="n">return_value</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># Always available</span>

    <span class="c1"># Mock customer service</span>
    <span class="n">customer_service</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>
    <span class="n">mock_customer</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>
    <span class="n">mock_customer</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s2">"active"</span>
    <span class="n">mock_customer</span><span class="o">.</span><span class="n">outstanding_balance</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"0.00"</span><span class="p">)</span>
    <span class="n">customer_service</span><span class="o">.</span><span class="n">get_customer_async</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">(</span><span class="n">return_value</span><span class="o">=</span><span class="n">mock_customer</span><span class="p">)</span>
    <span class="n">customer_service</span><span class="o">.</span><span class="n">get_today_order_count</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">(</span><span class="n">return_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Mock menu service</span>
    <span class="n">menu_service</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>
    <span class="n">mock_recipe</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>
    <span class="n">mock_recipe</span><span class="o">.</span><span class="n">base_ingredients</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">menu_service</span><span class="o">.</span><span class="n">get_recipe_async</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">(</span><span class="n">return_value</span><span class="o">=</span><span class="n">mock_recipe</span><span class="p">)</span>

    <span class="n">mock_menu_item</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>
    <span class="n">mock_menu_item</span><span class="o">.</span><span class="n">is_available</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">mock_menu_item</span><span class="o">.</span><span class="n">available_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"small"</span><span class="p">,</span> <span class="s2">"medium"</span><span class="p">,</span> <span class="s2">"large"</span><span class="p">]</span>
    <span class="n">mock_menu_item</span><span class="o">.</span><span class="n">is_seasonal</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">mock_menu_item</span><span class="o">.</span><span class="n">get_price_for_size</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">(</span><span class="n">return_value</span><span class="o">=</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">"18.99"</span><span class="p">))</span>
    <span class="n">menu_service</span><span class="o">.</span><span class="n">get_menu_item_async</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">(</span><span class="n">return_value</span><span class="o">=</span><span class="n">mock_menu_item</span><span class="p">)</span>

    <span class="n">service_provider</span><span class="o">.</span><span class="n">get_service</span><span class="o">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">service_type</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">'InventoryService'</span><span class="p">:</span> <span class="n">inventory_service</span><span class="p">,</span>
        <span class="s1">'CustomerService'</span><span class="p">:</span> <span class="n">customer_service</span><span class="p">,</span>
        <span class="s1">'MenuService'</span><span class="p">:</span> <span class="n">menu_service</span>
    <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">service_type</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">service_type</span><span class="p">,</span> <span class="s1">'__name__'</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">service_type</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">service_provider</span>
</code></pre></div>
<h3 id="performance-testing">Performance Testing<a class="headerlink" href="#performance-testing" title="Permanent link">¬∂</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">concurrent.futures</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThreadPoolExecutor</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TestValidationPerformance</span><span class="p">:</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_validation_performance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valid_order_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Test validation performance with large datasets."""</span>

        <span class="c1"># Create 100 order variations</span>
        <span class="n">orders_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
            <span class="n">order_data</span> <span class="o">=</span> <span class="n">valid_order_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">order_data</span><span class="p">[</span><span class="s2">"order_id"</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"ORD_20241201_</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">03d</span><span class="si">}</span><span class="s2">"</span>
            <span class="n">orders_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">order_data</span><span class="p">)</span>

        <span class="c1"># Time validation</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="n">valid_orders</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">order_data</span> <span class="ow">in</span> <span class="n">orders_data</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">order</span> <span class="o">=</span> <span class="n">PizzaOrderModel</span><span class="p">(</span><span class="o">**</span><span class="n">order_data</span><span class="p">)</span>
                <span class="n">valid_orders</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>  <span class="c1"># Skip invalid orders</span>

        <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"‚úÖ Validated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_orders</span><span class="p">)</span><span class="si">}</span><span class="s2"> orders in </span><span class="si">{</span><span class="n">duration</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">s"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"üìä Average validation time: </span><span class="si">{</span><span class="p">(</span><span class="n">duration</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">orders_data</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">ms per order"</span><span class="p">)</span>

        <span class="c1"># Performance assertion</span>
        <span class="k">assert</span> <span class="n">duration</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Validation took too long: </span><span class="si">{</span><span class="n">duration</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">s"</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_orders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">"Some valid orders failed validation"</span>
</code></pre></div>
<h2 id="error-aggregation-and-reporting">üìä Error Aggregation and Reporting<a class="headerlink" href="#error-aggregation-and-reporting" title="Permanent link">¬∂</a></h2>
<h3 id="comprehensive-error-handling">Comprehensive Error Handling<a class="headerlink" href="#comprehensive-error-handling" title="Permanent link">¬∂</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">neuroglia.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">ValidationErrorAggregator</span><span class="p">,</span> <span class="n">ValidationReport</span>

<span class="k">class</span><span class="w"> </span><span class="nc">OrderValidationService</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Service for comprehensive order validation with detailed reporting."""</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service_provider</span><span class="p">:</span> <span class="n">ServiceProviderBase</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">business_validator</span> <span class="o">=</span> <span class="n">service_provider</span><span class="o">.</span><span class="n">get_service</span><span class="p">(</span><span class="n">PizzaOrderBusinessValidator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_aggregator</span> <span class="o">=</span> <span class="n">ValidationErrorAggregator</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">validate_order_comprehensively</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
                                           <span class="n">context</span><span class="p">:</span> <span class="n">ValidationContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValidationReport</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Perform comprehensive validation with detailed error reporting."""</span>

        <span class="n">validation_report</span> <span class="o">=</span> <span class="n">ValidationReport</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Step 1: Basic model validation</span>
            <span class="n">validation_report</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="s2">"Model Validation"</span><span class="p">)</span>
            <span class="n">order_model</span> <span class="o">=</span> <span class="n">PizzaOrderModel</span><span class="p">(</span><span class="o">**</span><span class="n">order_data</span><span class="p">)</span>
            <span class="n">validation_report</span><span class="o">.</span><span class="n">mark_step_success</span><span class="p">(</span><span class="s2">"Model Validation"</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">validation_report</span><span class="o">.</span><span class="n">mark_step_failed</span><span class="p">(</span><span class="s2">"Model Validation"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">validation_report</span>

        <span class="c1"># Step 2: Business rule validation</span>
        <span class="n">validation_report</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="s2">"Business Rules Validation"</span><span class="p">)</span>
        <span class="n">business_result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">business_validator</span><span class="o">.</span><span class="n">validate_order_business_rules</span><span class="p">(</span>
            <span class="n">order_model</span><span class="p">,</span> <span class="n">context</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">business_result</span><span class="o">.</span><span class="n">is_valid</span><span class="p">:</span>
            <span class="n">validation_report</span><span class="o">.</span><span class="n">mark_step_success</span><span class="p">(</span><span class="s2">"Business Rules Validation"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">validation_report</span><span class="o">.</span><span class="n">mark_step_failed</span><span class="p">(</span>
                <span class="s2">"Business Rules Validation"</span><span class="p">,</span>
                <span class="n">business_result</span><span class="o">.</span><span class="n">errors</span>
            <span class="p">)</span>
            <span class="n">validation_report</span><span class="o">.</span><span class="n">add_warnings</span><span class="p">(</span><span class="n">business_result</span><span class="o">.</span><span class="n">warnings</span><span class="p">)</span>

        <span class="c1"># Step 3: Context-specific validation</span>
        <span class="n">validation_report</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="s2">"Context Validation"</span><span class="p">)</span>
        <span class="n">context_result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_context_specific_rules</span><span class="p">(</span><span class="n">order_model</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">context_result</span><span class="o">.</span><span class="n">is_valid</span><span class="p">:</span>
            <span class="n">validation_report</span><span class="o">.</span><span class="n">mark_step_success</span><span class="p">(</span><span class="s2">"Context Validation"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">validation_report</span><span class="o">.</span><span class="n">mark_step_failed</span><span class="p">(</span><span class="s2">"Context Validation"</span><span class="p">,</span> <span class="n">context_result</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span>

        <span class="c1"># Generate comprehensive report</span>
        <span class="n">validation_report</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">"üìã Validation Report:"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Overall Status: </span><span class="si">{</span><span class="s1">'‚úÖ VALID'</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">validation_report</span><span class="o">.</span><span class="n">is_valid</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">'‚ùå INVALID'</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Total Errors: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">validation_report</span><span class="o">.</span><span class="n">all_errors</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Total Warnings: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">validation_report</span><span class="o">.</span><span class="n">all_warnings</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">validation_report</span><span class="o">.</span><span class="n">all_errors</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">üö® Validation Errors:"</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">validation_report</span><span class="o">.</span><span class="n">all_errors</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  ‚Ä¢ </span><span class="si">{</span><span class="n">error</span><span class="o">.</span><span class="n">field</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">error</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">validation_report</span><span class="o">.</span><span class="n">all_warnings</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">‚ö†Ô∏è Validation Warnings:"</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">warning</span> <span class="ow">in</span> <span class="n">validation_report</span><span class="o">.</span><span class="n">all_warnings</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  ‚Ä¢ </span><span class="si">{</span><span class="n">warning</span><span class="o">.</span><span class="n">field</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">warning</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">warning</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">validation_report</span>
</code></pre></div>
<h2 id="related-documentation">üîó Related Documentation<a class="headerlink" href="#related-documentation" title="Permanent link">¬∂</a></h2>
<ul>
<li><a href="dependency-injection.md">üîß Dependency Injection</a> - Service registration for validators</li>
<li><a href="../case-conversion-utilities/">üîÑ Case Conversion Utilities</a> - Model field transformations</li>
<li><a href="cqrs-mediation.md">üì® CQRS &amp; Mediation</a> - Command validation patterns</li>
<li><a href="../http-service-client/">üåê HTTP Service Client</a> - Request/response validation</li>
<li><a href="../data-access/">üìÅ Data Access</a> - Data persistence validation</li>
</ul>
<hr/>
<p>The Enhanced Model Validation system provides comprehensive data integrity enforcement
throughout Mario's Pizzeria application. Through business rules, contextual validation,
and detailed error reporting, the system ensures reliable operations while providing
clear feedback for resolution of validation issues.</p>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/bvandewe/pyneuro" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "search.highlight", "search.share"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
</body>
</html>