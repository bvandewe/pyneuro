
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../redis-cache-repository/" rel="prev"/>
<link href="../case-conversion-utilities/" rel="next"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.20" name="generator"/>
<title>HTTP Service Client - Neuroglia Python Framework</title>
<link href="../../assets/stylesheets/main.e53b48f4.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="blue" data-md-color-primary="blue" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#http-service-client">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Neuroglia Python Framework" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Neuroglia Python Framework">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Neuroglia Python Framework
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              HTTP Service Client
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="blue" data-md-color-media="" data-md-color-primary="blue" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="blue" data-md-color-media="" data-md-color-primary="blue" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<a aria-label="Share" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="Share">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
</a>
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
        
  
  
    
  
  Home

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../getting-started/">
          
  
  
  Getting Started

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../mario-pizzeria/">
        
  
  
    
  
  Mario Pizzeria

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../patterns/">
          
  
  
  Patterns

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../">
          
  
  
  Features

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../guides/">
          
  
  
  Guides

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../samples/">
          
  
  
  Samples

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../references/python_type_hints/">
          
  
  
  References

        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Neuroglia Python Framework" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Neuroglia Python Framework">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    Neuroglia Python Framework
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Home
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Getting Started
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../getting-started/">
<span class="md-ellipsis">
    Overview
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../guides/3-min-bootstrap/">
<span class="md-ellipsis">
    3-Minute Bootstrap
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../guides/local-development/">
<span class="md-ellipsis">
    Local Development Setup
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../guides/mario-pizzeria-tutorial/">
<span class="md-ellipsis">
    Mario's Pizzeria Tutorial
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../mario-pizzeria/">
<span class="md-ellipsis">
    Mario Pizzeria
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Patterns
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Patterns
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/">
<span class="md-ellipsis">
    Overview
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/clean-architecture/">
<span class="md-ellipsis">
    Clean Architecture
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/cqrs/">
<span class="md-ellipsis">
    CQRS
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/event-driven/">
<span class="md-ellipsis">
    Event-Driven
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/repository/">
<span class="md-ellipsis">
    Repository
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/resource-oriented-architecture/">
<span class="md-ellipsis">
    Resource-Oriented Architecture
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/watcher-reconciliation-patterns/">
<span class="md-ellipsis">
    Watcher &amp; Reconciliation Patterns
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patterns/watcher-reconciliation-execution/">
<span class="md-ellipsis">
    Watcher &amp; Reconciliation Execution
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
<span class="md-ellipsis">
    Features
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Features
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Overview
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dependency-injection/">
<span class="md-ellipsis">
    Dependency Injection
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cqrs-mediation/">
<span class="md-ellipsis">
    CQRS &amp; Mediation
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../mvc-controllers/">
<span class="md-ellipsis">
    MVC Controllers
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../data-access/">
<span class="md-ellipsis">
    Data Access
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../event-sourcing/">
<span class="md-ellipsis">
    Event Sourcing
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../serialization/">
<span class="md-ellipsis">
    Serialization
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../object-mapping/">
<span class="md-ellipsis">
    Object Mapping
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../reactive-programming/">
<span class="md-ellipsis">
    Reactive Programming
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../background-task-scheduling/">
<span class="md-ellipsis">
    Background Task Scheduling
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../redis-cache-repository/">
<span class="md-ellipsis">
    Redis Cache Repository
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    HTTP Service Client
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    HTTP Service Client
    
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
<span class="md-ellipsis">
      🎯 Overview
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#architecture">
<span class="md-ellipsis">
      🏗️ Architecture
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-usage">
<span class="md-ellipsis">
      🚀 Basic Usage
    </span>
</a>
<nav aria-label="🚀 Basic Usage" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#service-registration">
<span class="md-ellipsis">
      Service Registration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#simple-http-operations">
<span class="md-ellipsis">
      Simple HTTP Operations
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#circuit-breaker-pattern">
<span class="md-ellipsis">
      🔄 Circuit Breaker Pattern
    </span>
</a>
<nav aria-label="🔄 Circuit Breaker Pattern" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#resilient-external-service-integration">
<span class="md-ellipsis">
      Resilient External Service Integration
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#retry-policies">
<span class="md-ellipsis">
      🔄 Retry Policies
    </span>
</a>
<nav aria-label="🔄 Retry Policies" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#configurable-retry-strategies">
<span class="md-ellipsis">
      Configurable Retry Strategies
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#requestresponse-interception">
<span class="md-ellipsis">
      🔍 Request/Response Interception
    </span>
</a>
<nav aria-label="🔍 Request/Response Interception" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#middleware-for-cross-cutting-concerns">
<span class="md-ellipsis">
      Middleware for Cross-Cutting Concerns
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#registering-interceptors">
<span class="md-ellipsis">
      Registering Interceptors
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#testing">
<span class="md-ellipsis">
      🧪 Testing
    </span>
</a>
<nav aria-label="🧪 Testing" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#unit-testing-with-http-mocks">
<span class="md-ellipsis">
      Unit Testing with HTTP Mocks
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#integration-testing-with-test-servers">
<span class="md-ellipsis">
      Integration Testing with Test Servers
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#monitoring-and-observability">
<span class="md-ellipsis">
      📊 Monitoring and Observability
    </span>
</a>
<nav aria-label="📊 Monitoring and Observability" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#http-client-metrics">
<span class="md-ellipsis">
      HTTP Client Metrics
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#advanced-configuration">
<span class="md-ellipsis">
      🔧 Advanced Configuration
    </span>
</a>
<nav aria-label="🔧 Advanced Configuration" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#connection-pool-and-performance-tuning">
<span class="md-ellipsis">
      Connection Pool and Performance Tuning
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#related-documentation">
<span class="md-ellipsis">
      🔗 Related Documentation
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../case-conversion-utilities/">
<span class="md-ellipsis">
    Case Conversion Utilities
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../enhanced-model-validation/">
<span class="md-ellipsis">
    Enhanced Model Validation
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../mermaid-diagrams/">
<span class="md-ellipsis">
    Mermaid Diagrams
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-ellipsis">
    Guides
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Guides
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../guides/">
<span class="md-ellipsis">
    Overview
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../guides/project-setup/">
<span class="md-ellipsis">
    Project Setup
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../guides/testing-setup/">
<span class="md-ellipsis">
    Testing Setup
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
<span class="md-ellipsis">
    Samples
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            Samples
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../samples/">
<span class="md-ellipsis">
    Overview
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../samples/openbank/">
<span class="md-ellipsis">
    OpenBank
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../samples/api_gateway/">
<span class="md-ellipsis">
    API Gateway
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../samples/desktop_controller/">
<span class="md-ellipsis">
    Desktop Controller
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
<span class="md-ellipsis">
    References
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
            References
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../references/python_type_hints/">
<span class="md-ellipsis">
    Python Type hints
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../references/python_generic_types/">
<span class="md-ellipsis">
    Python Generic Types
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
<span class="md-ellipsis">
      🎯 Overview
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#architecture">
<span class="md-ellipsis">
      🏗️ Architecture
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-usage">
<span class="md-ellipsis">
      🚀 Basic Usage
    </span>
</a>
<nav aria-label="🚀 Basic Usage" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#service-registration">
<span class="md-ellipsis">
      Service Registration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#simple-http-operations">
<span class="md-ellipsis">
      Simple HTTP Operations
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#circuit-breaker-pattern">
<span class="md-ellipsis">
      🔄 Circuit Breaker Pattern
    </span>
</a>
<nav aria-label="🔄 Circuit Breaker Pattern" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#resilient-external-service-integration">
<span class="md-ellipsis">
      Resilient External Service Integration
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#retry-policies">
<span class="md-ellipsis">
      🔄 Retry Policies
    </span>
</a>
<nav aria-label="🔄 Retry Policies" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#configurable-retry-strategies">
<span class="md-ellipsis">
      Configurable Retry Strategies
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#requestresponse-interception">
<span class="md-ellipsis">
      🔍 Request/Response Interception
    </span>
</a>
<nav aria-label="🔍 Request/Response Interception" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#middleware-for-cross-cutting-concerns">
<span class="md-ellipsis">
      Middleware for Cross-Cutting Concerns
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#registering-interceptors">
<span class="md-ellipsis">
      Registering Interceptors
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#testing">
<span class="md-ellipsis">
      🧪 Testing
    </span>
</a>
<nav aria-label="🧪 Testing" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#unit-testing-with-http-mocks">
<span class="md-ellipsis">
      Unit Testing with HTTP Mocks
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#integration-testing-with-test-servers">
<span class="md-ellipsis">
      Integration Testing with Test Servers
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#monitoring-and-observability">
<span class="md-ellipsis">
      📊 Monitoring and Observability
    </span>
</a>
<nav aria-label="📊 Monitoring and Observability" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#http-client-metrics">
<span class="md-ellipsis">
      HTTP Client Metrics
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#advanced-configuration">
<span class="md-ellipsis">
      🔧 Advanced Configuration
    </span>
</a>
<nav aria-label="🔧 Advanced Configuration" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#connection-pool-and-performance-tuning">
<span class="md-ellipsis">
      Connection Pool and Performance Tuning
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#related-documentation">
<span class="md-ellipsis">
      🔗 Related Documentation
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="http-service-client">🌐 HTTP Service Client<a class="headerlink" href="#http-service-client" title="Permanent link">¶</a></h1>
<p>The Neuroglia framework provides enterprise-grade HTTP client capabilities with advanced resilience patterns, enabling reliable communication with external services through circuit breakers, retry policies, and comprehensive request/response interception.</p>
<h2 id="overview">🎯 Overview<a class="headerlink" href="#overview" title="Permanent link">¶</a></h2>
<p>Modern microservices rely heavily on external service communication for payment processing, third-party APIs, and inter-service coordination. The framework's HTTP client implementation provides:</p>
<ul>
<li><strong>Circuit Breaker Pattern</strong>: Protection against cascading failures</li>
<li><strong>Retry Policies</strong>: Configurable retry strategies with exponential backoff</li>
<li><strong>Request/Response Interception</strong>: Middleware for authentication, logging, and monitoring</li>
<li><strong>Connection Pooling</strong>: Optimized HTTP connection management</li>
<li><strong>Timeout Management</strong>: Configurable timeouts for different scenarios</li>
<li><strong>Request/Response Validation</strong>: Automatic data validation and transformation</li>
</ul>
<h2 id="architecture">🏗️ Architecture<a class="headerlink" href="#architecture" title="Permanent link">¶</a></h2>
<pre class="mermaid"><code>graph TB
    subgraph "🍕 Mario's Pizzeria Services"
        OrderService[Order Service]
        PaymentService[Payment Service]
        DeliveryService[Delivery Service]
        NotificationService[Notification Service]
    end

    subgraph "🌐 HTTP Service Client"
        HttpClient[HTTP Client Manager]
        CircuitBreaker[Circuit Breaker]
        RetryPolicy[Retry Policy]
        Interceptors[Request/Response Interceptors]
    end

    subgraph "🔌 External Services"
        PaymentGateway[Payment Gateway API]
        DeliveryAPI[Delivery Tracking API]
        EmailService[Email Service API]
        SMSService[SMS Service API]
    end

    OrderService --&gt; HttpClient
    PaymentService --&gt; HttpClient
    DeliveryService --&gt; HttpClient
    NotificationService --&gt; HttpClient

    HttpClient --&gt; CircuitBreaker
    HttpClient --&gt; RetryPolicy
    HttpClient --&gt; Interceptors

    CircuitBreaker --&gt; PaymentGateway
    CircuitBreaker --&gt; DeliveryAPI
    CircuitBreaker --&gt; EmailService
    CircuitBreaker --&gt; SMSService

    style HttpClient fill:#e3f2fd
    style CircuitBreaker fill:#ffebee
    style RetryPolicy fill:#e8f5e8
    style Interceptors fill:#fff3e0</code></pre>
<h2 id="basic-usage">🚀 Basic Usage<a class="headerlink" href="#basic-usage" title="Permanent link">¶</a></h2>
<h3 id="service-registration">Service Registration<a class="headerlink" href="#service-registration" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">neuroglia.hosting.web</span><span class="w"> </span><span class="kn">import</span> <span class="n">WebApplicationBuilder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">neuroglia.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">HttpServiceClient</span><span class="p">,</span> <span class="n">HttpClientConfig</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_app</span><span class="p">():</span>
    <span class="n">builder</span> <span class="o">=</span> <span class="n">WebApplicationBuilder</span><span class="p">()</span>

    <span class="c1"># Register HTTP service client</span>
    <span class="n">http_config</span> <span class="o">=</span> <span class="n">HttpClientConfig</span><span class="p">(</span>
        <span class="n">base_timeout</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span>
        <span class="n">connection_timeout</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
        <span class="n">max_connections</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">max_connections_per_host</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">enable_circuit_breaker</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">enable_retry_policy</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">builder</span><span class="o">.</span><span class="n">services</span><span class="o">.</span><span class="n">add_http_service_client</span><span class="p">(</span><span class="n">http_config</span><span class="p">)</span>

    <span class="n">app</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">app</span>
</code></pre></div>
<h3 id="simple-http-operations">Simple HTTP Operations<a class="headerlink" href="#simple-http-operations" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">neuroglia.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">HttpServiceClient</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">neuroglia.dependency_injection</span><span class="w"> </span><span class="kn">import</span> <span class="n">ServiceProviderBase</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PaymentGatewayService</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service_provider</span><span class="p">:</span> <span class="n">ServiceProviderBase</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">http_client</span> <span class="o">=</span> <span class="n">service_provider</span><span class="o">.</span><span class="n">get_service</span><span class="p">(</span><span class="n">HttpServiceClient</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span> <span class="o">=</span> <span class="s2">"https://api.payment-gateway.com/v1"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s2">"your_api_key_here"</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">charge_customer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">currency</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"USD"</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Charge customer payment through external gateway."""</span>

        <span class="n">payment_request</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">"order_id"</span><span class="p">:</span> <span class="n">order_id</span><span class="p">,</span>
            <span class="s2">"amount"</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
            <span class="s2">"currency"</span><span class="p">:</span> <span class="n">currency</span><span class="p">,</span>
            <span class="s2">"description"</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"Mario's Pizzeria Order </span><span class="si">{</span><span class="n">order_id</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
            <span class="s2">"metadata"</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">"restaurant"</span><span class="p">:</span> <span class="s2">"marios_pizzeria"</span><span class="p">,</span>
                <span class="s2">"order_type"</span><span class="p">:</span> <span class="s2">"online"</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">"Authorization"</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"Bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
            <span class="s2">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
            <span class="s2">"X-Idempotency-Key"</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"order_</span><span class="si">{</span><span class="n">order_id</span><span class="si">}</span><span class="s2">"</span>
        <span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">http_client</span><span class="o">.</span><span class="n">post_async</span><span class="p">(</span>
                <span class="n">url</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/charges"</span><span class="p">,</span>
                <span class="n">json</span><span class="o">=</span><span class="n">payment_request</span><span class="p">,</span>
                <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
                <span class="n">timeout</span><span class="o">=</span><span class="mf">15.0</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">is_success</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"💳 Payment successful for order </span><span class="si">{</span><span class="n">order_id</span><span class="si">}</span><span class="s2">: $</span><span class="si">{</span><span class="n">amount</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"❌ Payment failed for order </span><span class="si">{</span><span class="n">order_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">PaymentProcessingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Payment failed: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"💥 Payment service error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">PaymentServiceUnavailableError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Cannot process payment: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">refund_payment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">charge_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Process refund through payment gateway."""</span>

        <span class="n">refund_request</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">"charge_id"</span><span class="p">:</span> <span class="n">charge_id</span><span class="p">,</span>
            <span class="s2">"reason"</span><span class="p">:</span> <span class="s2">"customer_request"</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">amount</span><span class="p">:</span>
            <span class="n">refund_request</span><span class="p">[</span><span class="s2">"amount"</span><span class="p">]</span> <span class="o">=</span> <span class="n">amount</span>

        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">"Authorization"</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"Bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
            <span class="s2">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/json"</span>
        <span class="p">}</span>

        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">http_client</span><span class="o">.</span><span class="n">post_async</span><span class="p">(</span>
            <span class="n">url</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/refunds"</span><span class="p">,</span>
            <span class="n">json</span><span class="o">=</span><span class="n">refund_request</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="n">headers</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">is_success</span><span class="p">:</span>
            <span class="n">refund_data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"💰 Refund processed: </span><span class="si">{</span><span class="n">refund_data</span><span class="p">[</span><span class="s1">'refund_id'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">refund_data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RefundProcessingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Refund failed: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
<h2 id="circuit-breaker-pattern">🔄 Circuit Breaker Pattern<a class="headerlink" href="#circuit-breaker-pattern" title="Permanent link">¶</a></h2>
<h3 id="resilient-external-service-integration">Resilient External Service Integration<a class="headerlink" href="#resilient-external-service-integration" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">neuroglia.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">CircuitBreakerPolicy</span><span class="p">,</span> <span class="n">CircuitBreakerState</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DeliveryTrackingService</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service_provider</span><span class="p">:</span> <span class="n">ServiceProviderBase</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">http_client</span> <span class="o">=</span> <span class="n">service_provider</span><span class="o">.</span><span class="n">get_service</span><span class="p">(</span><span class="n">HttpServiceClient</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span> <span class="o">=</span> <span class="s2">"https://api.delivery-service.com/v2"</span>

        <span class="c1"># Configure circuit breaker for delivery API</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">circuit_breaker</span> <span class="o">=</span> <span class="n">CircuitBreakerPolicy</span><span class="p">(</span>
            <span class="n">failure_threshold</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>        <span class="c1"># Open after 5 failures</span>
            <span class="n">recovery_timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>        <span class="c1"># Try recovery after 60 seconds</span>
            <span class="n">success_threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>        <span class="c1"># Close after 3 successful calls</span>
            <span class="n">timeout</span><span class="o">=</span><span class="mf">10.0</span>               <span class="c1"># Individual request timeout</span>
        <span class="p">)</span>

    <span class="nd">@circuit_breaker</span><span class="o">.</span><span class="n">apply</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create_delivery_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">delivery_address</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Create delivery request with circuit breaker protection."""</span>

        <span class="n">delivery_request</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">"order_id"</span><span class="p">:</span> <span class="n">order_id</span><span class="p">,</span>
            <span class="s2">"pickup_address"</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">"street"</span><span class="p">:</span> <span class="s2">"123 Pizza Street"</span><span class="p">,</span>
                <span class="s2">"city"</span><span class="p">:</span> <span class="s2">"Pizza City"</span><span class="p">,</span>
                <span class="s2">"zip"</span><span class="p">:</span> <span class="s2">"12345"</span>
            <span class="p">},</span>
            <span class="s2">"delivery_address"</span><span class="p">:</span> <span class="n">delivery_address</span><span class="p">,</span>
            <span class="s2">"priority"</span><span class="p">:</span> <span class="s2">"standard"</span><span class="p">,</span>
            <span class="s2">"special_instructions"</span><span class="p">:</span> <span class="s2">"Handle with care - hot pizza!"</span>
        <span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">http_client</span><span class="o">.</span><span class="n">post_async</span><span class="p">(</span>
                <span class="n">url</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/deliveries"</span><span class="p">,</span>
                <span class="n">json</span><span class="o">=</span><span class="n">delivery_request</span><span class="p">,</span>
                <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">circuit_breaker</span><span class="o">.</span><span class="n">timeout</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">is_success</span><span class="p">:</span>
                <span class="n">delivery_data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"🚚 Delivery scheduled: </span><span class="si">{</span><span class="n">delivery_data</span><span class="p">[</span><span class="s1">'tracking_id'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">delivery_data</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">DeliveryServiceError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Delivery creation failed: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"🔴 Delivery service unavailable: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="c1"># Circuit breaker will handle this failure</span>
            <span class="k">raise</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_delivery_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tracking_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Get delivery status with fallback handling."""</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circuit_breaker</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">CircuitBreakerState</span><span class="o">.</span><span class="n">OPEN</span><span class="p">:</span>
            <span class="c1"># Circuit is open - use fallback</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fallback_delivery_status</span><span class="p">(</span><span class="n">tracking_id</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">http_client</span><span class="o">.</span><span class="n">get_async</span><span class="p">(</span>
                <span class="n">url</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/deliveries/</span><span class="si">{</span><span class="n">tracking_id</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                <span class="n">timeout</span><span class="o">=</span><span class="mf">5.0</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">is_success</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fallback_delivery_status</span><span class="p">(</span><span class="n">tracking_id</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fallback_delivery_status</span><span class="p">(</span><span class="n">tracking_id</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_fallback_delivery_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tracking_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Fallback delivery status when service is unavailable."""</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"📋 Using fallback status for delivery </span><span class="si">{</span><span class="n">tracking_id</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">"tracking_id"</span><span class="p">:</span> <span class="n">tracking_id</span><span class="p">,</span>
            <span class="s2">"status"</span><span class="p">:</span> <span class="s2">"in_transit"</span><span class="p">,</span>
            <span class="s2">"estimated_delivery"</span><span class="p">:</span> <span class="s2">"Service temporarily unavailable"</span><span class="p">,</span>
            <span class="s2">"fallback"</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">}</span>
</code></pre></div>
<h2 id="retry-policies">🔄 Retry Policies<a class="headerlink" href="#retry-policies" title="Permanent link">¶</a></h2>
<h3 id="configurable-retry-strategies">Configurable Retry Strategies<a class="headerlink" href="#configurable-retry-strategies" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">neuroglia.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">RetryPolicy</span><span class="p">,</span> <span class="n">ExponentialBackoff</span><span class="p">,</span> <span class="n">RetryCondition</span>

<span class="k">class</span><span class="w"> </span><span class="nc">NotificationService</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service_provider</span><span class="p">:</span> <span class="n">ServiceProviderBase</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">http_client</span> <span class="o">=</span> <span class="n">service_provider</span><span class="o">.</span><span class="n">get_service</span><span class="p">(</span><span class="n">HttpServiceClient</span><span class="p">)</span>

        <span class="c1"># Configure retry policy for notifications</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retry_policy</span> <span class="o">=</span> <span class="n">RetryPolicy</span><span class="p">(</span>
            <span class="n">max_attempts</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">backoff_strategy</span><span class="o">=</span><span class="n">ExponentialBackoff</span><span class="p">(</span>
                <span class="n">initial_delay</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">max_delay</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span>
                <span class="n">backoff_factor</span><span class="o">=</span><span class="mf">2.0</span>
            <span class="p">),</span>
            <span class="n">retry_conditions</span><span class="o">=</span><span class="p">[</span>
                <span class="n">RetryCondition</span><span class="o">.</span><span class="n">on_timeout</span><span class="p">(),</span>
                <span class="n">RetryCondition</span><span class="o">.</span><span class="n">on_status_codes</span><span class="p">([</span><span class="mi">429</span><span class="p">,</span> <span class="mi">502</span><span class="p">,</span> <span class="mi">503</span><span class="p">,</span> <span class="mi">504</span><span class="p">]),</span>
                <span class="n">RetryCondition</span><span class="o">.</span><span class="n">on_exceptions</span><span class="p">([</span><span class="ne">ConnectionError</span><span class="p">,</span> <span class="ne">TimeoutError</span><span class="p">])</span>
            <span class="p">]</span>
        <span class="p">)</span>

    <span class="nd">@retry_policy</span><span class="o">.</span><span class="n">apply</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">send_order_confirmation_email</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">customer_email</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">order_details</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Send order confirmation email with retry policy."""</span>

        <span class="n">email_request</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">"to"</span><span class="p">:</span> <span class="n">customer_email</span><span class="p">,</span>
            <span class="s2">"subject"</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"🍕 Order Confirmation - #</span><span class="si">{</span><span class="n">order_details</span><span class="p">[</span><span class="s1">'order_id'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
            <span class="s2">"template"</span><span class="p">:</span> <span class="s2">"order_confirmation"</span><span class="p">,</span>
            <span class="s2">"variables"</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">"customer_name"</span><span class="p">:</span> <span class="n">order_details</span><span class="p">[</span><span class="s1">'customer_name'</span><span class="p">],</span>
                <span class="s2">"order_id"</span><span class="p">:</span> <span class="n">order_details</span><span class="p">[</span><span class="s1">'order_id'</span><span class="p">],</span>
                <span class="s2">"items"</span><span class="p">:</span> <span class="n">order_details</span><span class="p">[</span><span class="s1">'items'</span><span class="p">],</span>
                <span class="s2">"total_amount"</span><span class="p">:</span> <span class="n">order_details</span><span class="p">[</span><span class="s1">'total_amount'</span><span class="p">],</span>
                <span class="s2">"estimated_delivery"</span><span class="p">:</span> <span class="n">order_details</span><span class="p">[</span><span class="s1">'estimated_delivery'</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">http_client</span><span class="o">.</span><span class="n">post_async</span><span class="p">(</span>
            <span class="n">url</span><span class="o">=</span><span class="s2">"https://api.email-service.com/v1/send"</span><span class="p">,</span>
            <span class="n">json</span><span class="o">=</span><span class="n">email_request</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">"Authorization"</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"Bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_email_api_key</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                <span class="s2">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/json"</span>
            <span class="p">},</span>
            <span class="n">timeout</span><span class="o">=</span><span class="mf">10.0</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">is_success</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"📧 Order confirmation sent to </span><span class="si">{</span><span class="n">customer_email</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"Failed to send email: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">"</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"❌ </span><span class="si">{</span><span class="n">error_msg</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">EmailDeliveryError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

    <span class="nd">@retry_policy</span><span class="o">.</span><span class="n">apply</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">send_sms_notification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phone_number</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Send SMS notification with retry policy."""</span>

        <span class="n">sms_request</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">"to"</span><span class="p">:</span> <span class="n">phone_number</span><span class="p">,</span>
            <span class="s2">"message"</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span>
            <span class="s2">"from"</span><span class="p">:</span> <span class="s2">"Mario's Pizzeria"</span>
        <span class="p">}</span>

        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">http_client</span><span class="o">.</span><span class="n">post_async</span><span class="p">(</span>
            <span class="n">url</span><span class="o">=</span><span class="s2">"https://api.sms-service.com/v1/messages"</span><span class="p">,</span>
            <span class="n">json</span><span class="o">=</span><span class="n">sms_request</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">"Authorization"</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"Bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_sms_api_key</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                <span class="s2">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/json"</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">is_success</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"📱 SMS sent to </span><span class="si">{</span><span class="n">phone_number</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SMSDeliveryError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"SMS failed: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
<h2 id="requestresponse-interception">🔍 Request/Response Interception<a class="headerlink" href="#requestresponse-interception" title="Permanent link">¶</a></h2>
<h3 id="middleware-for-cross-cutting-concerns">Middleware for Cross-Cutting Concerns<a class="headerlink" href="#middleware-for-cross-cutting-concerns" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">neuroglia.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">RequestInterceptor</span><span class="p">,</span> <span class="n">ResponseInterceptor</span><span class="p">,</span> <span class="n">HttpContext</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AuthenticationInterceptor</span><span class="p">(</span><span class="n">RequestInterceptor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Add authentication to all external service requests."""</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">intercept_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">HttpRequest</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">HttpContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HttpRequest</span><span class="p">:</span>
        <span class="c1"># Add API key based on service</span>
        <span class="k">if</span> <span class="s2">"payment-gateway.com"</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">:</span>
            <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">"Authorization"</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"Bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_payment_api_key</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span>
        <span class="k">elif</span> <span class="s2">"delivery-service.com"</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">:</span>
            <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">"X-API-Key"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_delivery_api_key</span><span class="p">()</span>
        <span class="k">elif</span> <span class="s2">"email-service.com"</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">:</span>
            <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">"Authorization"</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"Bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_email_api_key</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span>

        <span class="c1"># Add common headers</span>
        <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">"User-Agent"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"MariosPizzeria/1.0"</span>
        <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">"X-Request-ID"</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">correlation_id</span>

        <span class="k">return</span> <span class="n">request</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_payment_api_key</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">"payment_api_key_here"</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_delivery_api_key</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">"delivery_api_key_here"</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_email_api_key</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">"email_api_key_here"</span>

<span class="k">class</span><span class="w"> </span><span class="nc">LoggingInterceptor</span><span class="p">(</span><span class="n">RequestInterceptor</span><span class="p">,</span> <span class="n">ResponseInterceptor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Log all HTTP requests and responses."""</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">intercept_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">HttpRequest</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">HttpContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HttpRequest</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"🌐 HTTP Request: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"📋 Headers: </span><span class="si">{</span><span class="nb">dict</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"📄 Request Body: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="n">context</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">request</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">intercept_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="n">HttpResponse</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">HttpContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HttpResponse</span><span class="p">:</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">context</span><span class="o">.</span><span class="n">start_time</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"📨 HTTP Response: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">duration</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s)"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"📄 Response Size: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes"</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">is_success</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"❌ Error Response: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">response</span>

<span class="k">class</span><span class="w"> </span><span class="nc">RateLimitInterceptor</span><span class="p">(</span><span class="n">RequestInterceptor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Handle rate limiting with backoff."""</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rate_limit_trackers</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">intercept_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">HttpRequest</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">HttpContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HttpRequest</span><span class="p">:</span>
        <span class="n">service_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_service_key</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>

        <span class="c1"># Check if we're rate limited</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_rate_limited</span><span class="p">(</span><span class="n">service_key</span><span class="p">):</span>
            <span class="n">wait_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rate_limit_wait_time</span><span class="p">(</span><span class="n">service_key</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"⏳ Rate limited for </span><span class="si">{</span><span class="n">service_key</span><span class="si">}</span><span class="s2">, waiting </span><span class="si">{</span><span class="n">wait_time</span><span class="si">}</span><span class="s2">s"</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">wait_time</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">request</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">intercept_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="n">HttpResponse</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">HttpContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HttpResponse</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">429</span><span class="p">:</span>  <span class="c1"># Too Many Requests</span>
            <span class="n">service_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_service_key</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle_rate_limit_response</span><span class="p">(</span><span class="n">service_key</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">response</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extract_service_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Extract service identifier from URL."""</span>
        <span class="k">if</span> <span class="s2">"payment-gateway.com"</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"payment_gateway"</span>
        <span class="k">elif</span> <span class="s2">"delivery-service.com"</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"delivery_service"</span>
        <span class="k">elif</span> <span class="s2">"email-service.com"</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"email_service"</span>
        <span class="k">return</span> <span class="s2">"unknown"</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_rate_limited</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Check if service is currently rate limited."""</span>
        <span class="n">tracker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_limit_trackers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">service_key</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tracker</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">tracker</span><span class="p">[</span><span class="s2">"retry_after"</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">handle_rate_limit_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="n">HttpResponse</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Handle rate limit response headers."""</span>
        <span class="n">retry_after</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"Retry-After"</span><span class="p">,</span> <span class="s2">"60"</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rate_limit_trackers</span><span class="p">[</span><span class="n">service_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">"retry_after"</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">retry_after</span><span class="p">),</span>
            <span class="s2">"limit_exceeded_at"</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="p">}</span>
</code></pre></div>
<h3 id="registering-interceptors">Registering Interceptors<a class="headerlink" href="#registering-interceptors" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">configure_http_interceptors</span><span class="p">(</span><span class="n">services</span><span class="p">:</span> <span class="n">ServiceCollection</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Configure HTTP client interceptors."""</span>

    <span class="c1"># Register interceptors in order of execution</span>
    <span class="n">services</span><span class="o">.</span><span class="n">add_singleton</span><span class="p">(</span><span class="n">AuthenticationInterceptor</span><span class="p">)</span>
    <span class="n">services</span><span class="o">.</span><span class="n">add_singleton</span><span class="p">(</span><span class="n">LoggingInterceptor</span><span class="p">)</span>
    <span class="n">services</span><span class="o">.</span><span class="n">add_singleton</span><span class="p">(</span><span class="n">RateLimitInterceptor</span><span class="p">)</span>

    <span class="c1"># Configure HTTP client with interceptors</span>
    <span class="n">http_config</span> <span class="o">=</span> <span class="n">HttpClientConfig</span><span class="p">(</span>
        <span class="n">request_interceptors</span><span class="o">=</span><span class="p">[</span>
            <span class="n">AuthenticationInterceptor</span><span class="p">,</span>
            <span class="n">RateLimitInterceptor</span><span class="p">,</span>
            <span class="n">LoggingInterceptor</span>
        <span class="p">],</span>
        <span class="n">response_interceptors</span><span class="o">=</span><span class="p">[</span>
            <span class="n">LoggingInterceptor</span><span class="p">,</span>
            <span class="n">RateLimitInterceptor</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="n">services</span><span class="o">.</span><span class="n">add_http_service_client</span><span class="p">(</span><span class="n">http_config</span><span class="p">)</span>
</code></pre></div>
<h2 id="testing">🧪 Testing<a class="headerlink" href="#testing" title="Permanent link">¶</a></h2>
<h3 id="unit-testing-with-http-mocks">Unit Testing with HTTP Mocks<a class="headerlink" href="#unit-testing-with-http-mocks" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">unittest.mock</span><span class="w"> </span><span class="kn">import</span> <span class="n">AsyncMock</span><span class="p">,</span> <span class="n">Mock</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">neuroglia.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">HttpServiceClient</span><span class="p">,</span> <span class="n">HttpResponse</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TestPaymentGatewayService</span><span class="p">:</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">mock_http_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">(</span><span class="n">spec</span><span class="o">=</span><span class="n">HttpServiceClient</span><span class="p">)</span>
        <span class="n">client</span><span class="o">.</span><span class="n">post_async</span> <span class="o">=</span> <span class="n">AsyncMock</span><span class="p">()</span>
        <span class="n">client</span><span class="o">.</span><span class="n">get_async</span> <span class="o">=</span> <span class="n">AsyncMock</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">client</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">payment_service</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_http_client</span><span class="p">):</span>
        <span class="n">service_provider</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>
        <span class="n">service_provider</span><span class="o">.</span><span class="n">get_service</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">mock_http_client</span>
        <span class="k">return</span> <span class="n">PaymentGatewayService</span><span class="p">(</span><span class="n">service_provider</span><span class="p">)</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_successful_payment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payment_service</span><span class="p">,</span> <span class="n">mock_http_client</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Test successful payment processing."""</span>

        <span class="c1"># Mock successful response</span>
        <span class="n">mock_response</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">(</span><span class="n">spec</span><span class="o">=</span><span class="n">HttpResponse</span><span class="p">)</span>
        <span class="n">mock_response</span><span class="o">.</span><span class="n">is_success</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">mock_response</span><span class="o">.</span><span class="n">json</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">"charge_id"</span><span class="p">:</span> <span class="s2">"ch_123456"</span><span class="p">,</span>
            <span class="s2">"status"</span><span class="p">:</span> <span class="s2">"succeeded"</span><span class="p">,</span>
            <span class="s2">"amount"</span><span class="p">:</span> <span class="mf">25.99</span>
        <span class="p">}</span>
        <span class="n">mock_http_client</span><span class="o">.</span><span class="n">post_async</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">mock_response</span>

        <span class="c1"># Test payment</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">payment_service</span><span class="o">.</span><span class="n">charge_customer</span><span class="p">(</span><span class="s2">"order_123"</span><span class="p">,</span> <span class="mf">25.99</span><span class="p">)</span>

        <span class="c1"># Verify request was made correctly</span>
        <span class="n">mock_http_client</span><span class="o">.</span><span class="n">post_async</span><span class="o">.</span><span class="n">assert_called_once</span><span class="p">()</span>
        <span class="n">call_args</span> <span class="o">=</span> <span class="n">mock_http_client</span><span class="o">.</span><span class="n">post_async</span><span class="o">.</span><span class="n">call_args</span>

        <span class="k">assert</span> <span class="s2">"charges"</span> <span class="ow">in</span> <span class="n">call_args</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"url"</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">call_args</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"json"</span><span class="p">][</span><span class="s2">"amount"</span><span class="p">]</span> <span class="o">==</span> <span class="mf">25.99</span>
        <span class="k">assert</span> <span class="n">call_args</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"json"</span><span class="p">][</span><span class="s2">"order_id"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"order_123"</span>

        <span class="c1"># Verify response</span>
        <span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="s2">"charge_id"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"ch_123456"</span>
        <span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="s2">"status"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"succeeded"</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_payment_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payment_service</span><span class="p">,</span> <span class="n">mock_http_client</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Test payment processing failure."""</span>

        <span class="c1"># Mock failed response</span>
        <span class="n">mock_response</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">(</span><span class="n">spec</span><span class="o">=</span><span class="n">HttpResponse</span><span class="p">)</span>
        <span class="n">mock_response</span><span class="o">.</span><span class="n">is_success</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">mock_response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">=</span> <span class="mi">402</span>
        <span class="n">mock_response</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"Insufficient funds"</span>
        <span class="n">mock_http_client</span><span class="o">.</span><span class="n">post_async</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">mock_response</span>

        <span class="c1"># Test payment failure</span>
        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="n">PaymentProcessingError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc_info</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">payment_service</span><span class="o">.</span><span class="n">charge_customer</span><span class="p">(</span><span class="s2">"order_123"</span><span class="p">,</span> <span class="mf">25.99</span><span class="p">)</span>

        <span class="k">assert</span> <span class="s2">"Payment failed"</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc_info</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_unavailable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payment_service</span><span class="p">,</span> <span class="n">mock_http_client</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Test handling of service unavailability."""</span>

        <span class="c1"># Mock connection error</span>
        <span class="n">mock_http_client</span><span class="o">.</span><span class="n">post_async</span><span class="o">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="s2">"Service unavailable"</span><span class="p">)</span>

        <span class="c1"># Test service unavailable handling</span>
        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="n">PaymentServiceUnavailableError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc_info</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">payment_service</span><span class="o">.</span><span class="n">charge_customer</span><span class="p">(</span><span class="s2">"order_123"</span><span class="p">,</span> <span class="mf">25.99</span><span class="p">)</span>

        <span class="k">assert</span> <span class="s2">"Cannot process payment"</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc_info</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</code></pre></div>
<h3 id="integration-testing-with-test-servers">Integration Testing with Test Servers<a class="headerlink" href="#integration-testing-with-test-servers" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">integration</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TestHttpServiceIntegration</span><span class="p">:</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_server</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Start test HTTP server for integration testing."""</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">aiohttp</span><span class="w"> </span><span class="kn">import</span> <span class="n">web</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">aiohttp.test_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">TestServer</span>

        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">payment_handler</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"amount"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">web</span><span class="o">.</span><span class="n">json_response</span><span class="p">(</span>
                    <span class="p">{</span><span class="s2">"error"</span><span class="p">:</span> <span class="s2">"Invalid amount"</span><span class="p">},</span>
                    <span class="n">status</span><span class="o">=</span><span class="mi">400</span>
                <span class="p">)</span>

            <span class="k">return</span> <span class="n">web</span><span class="o">.</span><span class="n">json_response</span><span class="p">({</span>
                <span class="s2">"charge_id"</span><span class="p">:</span> <span class="s2">"ch_test_123"</span><span class="p">,</span>
                <span class="s2">"status"</span><span class="p">:</span> <span class="s2">"succeeded"</span><span class="p">,</span>
                <span class="s2">"amount"</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">"amount"</span><span class="p">]</span>
            <span class="p">})</span>

        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">rate_limit_handler</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">web</span><span class="o">.</span><span class="n">json_response</span><span class="p">(</span>
                <span class="p">{</span><span class="s2">"error"</span><span class="p">:</span> <span class="s2">"Rate limit exceeded"</span><span class="p">},</span>
                <span class="n">status</span><span class="o">=</span><span class="mi">429</span><span class="p">,</span>
                <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">"Retry-After"</span><span class="p">:</span> <span class="s2">"5"</span><span class="p">}</span>
            <span class="p">)</span>

        <span class="n">app</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">()</span>
        <span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">add_post</span><span class="p">(</span><span class="s2">"/charges"</span><span class="p">,</span> <span class="n">payment_handler</span><span class="p">)</span>
        <span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">add_post</span><span class="p">(</span><span class="s2">"/rate-limited"</span><span class="p">,</span> <span class="n">rate_limit_handler</span><span class="p">)</span>

        <span class="n">server</span> <span class="o">=</span> <span class="n">TestServer</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">server</span><span class="o">.</span><span class="n">start_server</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">server</span>
        <span class="k">await</span> <span class="n">server</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">http_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">HttpClientConfig</span><span class="p">(</span>
            <span class="n">base_timeout</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
            <span class="n">enable_circuit_breaker</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">enable_retry_policy</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">HttpServiceClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_end_to_end_payment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_server</span><span class="p">,</span> <span class="n">http_client</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Test end-to-end payment processing."""</span>

        <span class="n">payment_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">"order_id"</span><span class="p">:</span> <span class="s2">"integration_test_order"</span><span class="p">,</span>
            <span class="s2">"amount"</span><span class="p">:</span> <span class="mf">19.99</span><span class="p">,</span>
            <span class="s2">"currency"</span><span class="p">:</span> <span class="s2">"USD"</span>
        <span class="p">}</span>

        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">http_client</span><span class="o">.</span><span class="n">post_async</span><span class="p">(</span>
            <span class="n">url</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">test_server</span><span class="o">.</span><span class="n">make_url</span><span class="p">(</span><span class="s1">'/charges'</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
            <span class="n">json</span><span class="o">=</span><span class="n">payment_data</span><span class="p">,</span>
            <span class="n">timeout</span><span class="o">=</span><span class="mf">10.0</span>
        <span class="p">)</span>

        <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">is_success</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="s2">"status"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"succeeded"</span>
        <span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="s2">"amount"</span><span class="p">]</span> <span class="o">==</span> <span class="mf">19.99</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_circuit_breaker_behavior</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_server</span><span class="p">,</span> <span class="n">http_client</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Test circuit breaker with failing service."""</span>

        <span class="c1"># Make multiple requests to trigger circuit breaker</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>  <span class="c1"># Trigger failure threshold</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">http_client</span><span class="o">.</span><span class="n">post_async</span><span class="p">(</span>
                    <span class="n">url</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">test_server</span><span class="o">.</span><span class="n">make_url</span><span class="p">(</span><span class="s1">'/rate-limited'</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                    <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s2">"test"</span><span class="p">:</span> <span class="s2">"data"</span><span class="p">},</span>
                    <span class="n">timeout</span><span class="o">=</span><span class="mf">1.0</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>  <span class="c1"># Expected failures</span>

        <span class="c1"># Circuit should now be open - next request should fail fast</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>  <span class="c1"># Circuit breaker should fail fast</span>
            <span class="k">await</span> <span class="n">http_client</span><span class="o">.</span><span class="n">post_async</span><span class="p">(</span>
                <span class="n">url</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">test_server</span><span class="o">.</span><span class="n">make_url</span><span class="p">(</span><span class="s1">'/rate-limited'</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s2">"test"</span><span class="p">:</span> <span class="s2">"data"</span><span class="p">}</span>
            <span class="p">)</span>

        <span class="n">duration</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">assert</span> <span class="n">duration</span> <span class="o">&lt;</span> <span class="mf">0.1</span>  <span class="c1"># Should fail fast, not wait for timeout</span>
</code></pre></div>
<h2 id="monitoring-and-observability">📊 Monitoring and Observability<a class="headerlink" href="#monitoring-and-observability" title="Permanent link">¶</a></h2>
<h3 id="http-client-metrics">HTTP Client Metrics<a class="headerlink" href="#http-client-metrics" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">neuroglia.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">HttpMetrics</span><span class="p">,</span> <span class="n">MetricsCollector</span>

<span class="k">class</span><span class="w"> </span><span class="nc">HttpServiceMonitor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">http_client</span><span class="p">:</span> <span class="n">HttpServiceClient</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">http_client</span> <span class="o">=</span> <span class="n">http_client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="n">HttpMetrics</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">track_request_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                                  <span class="n">status_code</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Track HTTP request metrics."""</span>

        <span class="c1"># Increment counters</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">increment_counter</span><span class="p">(</span><span class="sa">f</span><span class="s2">"http_requests_total"</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">"service"</span><span class="p">:</span> <span class="n">service_name</span><span class="p">,</span>
            <span class="s2">"endpoint"</span><span class="p">:</span> <span class="n">endpoint</span><span class="p">,</span>
            <span class="s2">"status_code"</span><span class="p">:</span> <span class="n">status_code</span>
        <span class="p">})</span>

        <span class="c1"># Track response times</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">observe_histogram</span><span class="p">(</span><span class="sa">f</span><span class="s2">"http_request_duration_seconds"</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">"service"</span><span class="p">:</span> <span class="n">service_name</span><span class="p">,</span>
            <span class="s2">"endpoint"</span><span class="p">:</span> <span class="n">endpoint</span>
        <span class="p">})</span>

        <span class="c1"># Track error rates</span>
        <span class="k">if</span> <span class="n">status_code</span> <span class="o">&gt;=</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">increment_counter</span><span class="p">(</span><span class="sa">f</span><span class="s2">"http_errors_total"</span><span class="p">,</span> <span class="p">{</span>
                <span class="s2">"service"</span><span class="p">:</span> <span class="n">service_name</span><span class="p">,</span>
                <span class="s2">"status_code"</span><span class="p">:</span> <span class="n">status_code</span>
            <span class="p">})</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_service_health_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Get HTTP service health summary."""</span>

        <span class="n">total_requests</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">get_counter</span><span class="p">(</span><span class="s2">"http_requests_total"</span><span class="p">)</span>
        <span class="n">total_errors</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">get_counter</span><span class="p">(</span><span class="s2">"http_errors_total"</span><span class="p">)</span>
        <span class="n">avg_duration</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">get_gauge</span><span class="p">(</span><span class="s2">"http_request_duration_seconds"</span><span class="p">)</span>

        <span class="n">error_rate</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_errors</span> <span class="o">/</span> <span class="n">total_requests</span><span class="p">)</span> <span class="k">if</span> <span class="n">total_requests</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">"total_requests"</span><span class="p">:</span> <span class="n">total_requests</span><span class="p">,</span>
            <span class="s2">"total_errors"</span><span class="p">:</span> <span class="n">total_errors</span><span class="p">,</span>
            <span class="s2">"error_rate"</span><span class="p">:</span> <span class="n">error_rate</span><span class="p">,</span>
            <span class="s2">"average_response_time"</span><span class="p">:</span> <span class="n">avg_duration</span><span class="p">,</span>
            <span class="s2">"circuit_breaker_states"</span><span class="p">:</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_circuit_breaker_states</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_circuit_breaker_states</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Get current circuit breaker states for all services."""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">"payment_gateway"</span><span class="p">:</span> <span class="s2">"closed"</span><span class="p">,</span>
            <span class="s2">"delivery_service"</span><span class="p">:</span> <span class="s2">"half_open"</span><span class="p">,</span>
            <span class="s2">"email_service"</span><span class="p">:</span> <span class="s2">"closed"</span><span class="p">,</span>
            <span class="s2">"sms_service"</span><span class="p">:</span> <span class="s2">"open"</span>
        <span class="p">}</span>
</code></pre></div>
<h2 id="advanced-configuration">🔧 Advanced Configuration<a class="headerlink" href="#advanced-configuration" title="Permanent link">¶</a></h2>
<h3 id="connection-pool-and-performance-tuning">Connection Pool and Performance Tuning<a class="headerlink" href="#connection-pool-and-performance-tuning" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">neuroglia.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">HttpClientConfig</span><span class="p">,</span> <span class="n">ConnectionPoolConfig</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_optimized_http_config</span><span class="p">():</span>
    <span class="n">connection_config</span> <span class="o">=</span> <span class="n">ConnectionPoolConfig</span><span class="p">(</span>
        <span class="c1"># Connection limits</span>
        <span class="n">max_connections</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">max_connections_per_host</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>

        <span class="c1"># Timeouts</span>
        <span class="n">connection_timeout</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
        <span class="n">request_timeout</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span>
        <span class="n">pool_timeout</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>

        <span class="c1"># Keep-alive settings</span>
        <span class="n">keep_alive_timeout</span><span class="o">=</span><span class="mf">75.0</span><span class="p">,</span>
        <span class="n">keep_alive_max_requests</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>

        <span class="c1"># SSL/TLS settings</span>
        <span class="n">ssl_verify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">ssl_cert_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ssl_key_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>

        <span class="c1"># Compression</span>
        <span class="n">enable_compression</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">compression_threshold</span><span class="o">=</span><span class="mi">1024</span>
    <span class="p">)</span>

    <span class="n">http_config</span> <span class="o">=</span> <span class="n">HttpClientConfig</span><span class="p">(</span>
        <span class="n">connection_pool</span><span class="o">=</span><span class="n">connection_config</span><span class="p">,</span>

        <span class="c1"># Default timeouts</span>
        <span class="n">base_timeout</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span>
        <span class="n">connection_timeout</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>

        <span class="c1"># Resilience patterns</span>
        <span class="n">enable_circuit_breaker</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">circuit_breaker_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">"failure_threshold"</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s2">"recovery_timeout"</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
            <span class="s2">"success_threshold"</span><span class="p">:</span> <span class="mi">3</span>
        <span class="p">},</span>

        <span class="n">enable_retry_policy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">retry_policy_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">"max_attempts"</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s2">"backoff_factor"</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s2">"max_delay"</span><span class="p">:</span> <span class="mf">60.0</span>
        <span class="p">},</span>

        <span class="c1"># Request/Response settings</span>
        <span class="n">max_response_size</span><span class="o">=</span><span class="mi">10</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">,</span>  <span class="c1"># 10MB</span>
        <span class="n">enable_request_compression</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">enable_response_decompression</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>

        <span class="c1"># Security</span>
        <span class="n">allowed_redirect_count</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">trust_env_proxy_settings</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">http_config</span>
</code></pre></div>
<h2 id="related-documentation">🔗 Related Documentation<a class="headerlink" href="#related-documentation" title="Permanent link">¶</a></h2>
<ul>
<li><a href="../background-task-scheduling/">⏰ Background Task Scheduling</a> - Scheduling external API calls</li>
<li><a href="../redis-cache-repository/">⚡ Redis Cache Repository</a> - Caching API responses</li>
<li><a href="../dependency-injection/">🔧 Dependency Injection</a> - Service registration patterns</li>
<li><a href="../enhanced-model-validation/">📊 Enhanced Model Validation</a> - Request/response validation</li>
<li><a href="../event-sourcing/">📨 Event Sourcing</a> - Event-driven external service integration</li>
</ul>
<hr/>
<p>The HTTP Service Client provides enterprise-grade capabilities for reliable external service
communication. Through circuit breakers, retry policies, and comprehensive interception,
Mario's Pizzeria can confidently integrate with payment gateways, delivery services, and
notification providers while maintaining system resilience and performance.</p>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/bvandewe/pyneuro" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "search.highlight", "search.share"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
</body>
</html>